"use strict";(self.webpackChunkakara=self.webpackChunkakara||[]).push([[281],{3905:(e,n,t)=>{t.d(n,{Zo:()=>m,kt:()=>N});var a=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var o=a.createContext({}),k=function(e){var n=a.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},m=function(e){var n=k(e.components);return a.createElement(o.Provider,{value:n},e.children)},s="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,i=e.originalType,o=e.parentName,m=p(e,["components","mdxType","originalType","parentName"]),s=k(t),u=l,N=s["".concat(o,".").concat(u)]||s[u]||d[u]||i;return t?a.createElement(N,r(r({ref:n},m),{},{components:t})):a.createElement(N,r({ref:n},m))}));function N(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var i=t.length,r=new Array(i);r[0]=u;var p={};for(var o in n)hasOwnProperty.call(n,o)&&(p[o]=n[o]);p.originalType=e,p[s]="string"==typeof e?e:l,r[1]=p;for(var k=2;k<i;k++)r[k]=t[k];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},7178:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>p,toc:()=>k});var a=t(7462),l=(t(7294),t(3905));const i={},r="Nginx\u5b66\u4e60",p={unversionedId:"\u90e8\u7f72\u5b66\u4e60/nginx",id:"\u90e8\u7f72\u5b66\u4e60/nginx",title:"Nginx\u5b66\u4e60",description:"\u5927\u90e8\u5206\u5185\u5bb9\u6765\u6e90\u4e8e\uff1a\u4e07\u5b57\u603b\u7ed3\uff0c\u4f53\u7cfb\u5316\u5e26\u4f60\u5168\u9762\u8ba4\u8bc6 Nginx \uff01",source:"@site/docs/\u90e8\u7f72\u5b66\u4e60/nginx.md",sourceDirName:"\u90e8\u7f72\u5b66\u4e60",slug:"/\u90e8\u7f72\u5b66\u4e60/nginx",permalink:"/blog/docs/\u90e8\u7f72\u5b66\u4e60/nginx",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/\u90e8\u7f72\u5b66\u4e60/nginx.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Django\u96c6\u6210\u4efb\u52a1\u961f\u5217Celery",permalink:"/blog/docs/Django/Django\u96c6\u6210\u4efb\u52a1\u961f\u5217Celery"},next:{title:"\u6162\u67e5\u8be2\u5bfc\u81f4\u670d\u52a1\u65e0\u6cd5\u54cd\u5e94",permalink:"/blog/docs/\u7ebf\u4e0a\u95ee\u9898/\u6162\u67e5\u8be2\u5bfc\u81f4\u670d\u52a1\u65e0\u6cd5\u54cd\u5e94"}},o={},k=[{value:"1. \u5b89\u88c5",id:"1-\u5b89\u88c5",level:2},{value:"yum\u5b89\u88c5",id:"yum\u5b89\u88c5",level:3},{value:"docker\u5b89\u88c5",id:"docker\u5b89\u88c5",level:3},{value:"2. Nginx \u5e38\u7528\u547d\u4ee4",id:"2-nginx-\u5e38\u7528\u547d\u4ee4",level:2},{value:"3. Nginx \u914d\u7f6e\u6587\u4ef6\u8be6\u89e3",id:"3-nginx-\u914d\u7f6e\u6587\u4ef6\u8be6\u89e3",level:2},{value:"3.1 \u4e3b\u8981\u7ed3\u6784",id:"31-\u4e3b\u8981\u7ed3\u6784",level:3},{value:"3.2 main \u6bb5\u6838\u5fc3\u53c2\u6570",id:"32-main-\u6bb5\u6838\u5fc3\u53c2\u6570",level:3},{value:"user",id:"user",level:4},{value:"pid",id:"pid",level:4},{value:"worker_rlimit_nofile_number",id:"worker_rlimit_nofile_number",level:4},{value:"worker_rlimit_core",id:"worker_rlimit_core",level:4},{value:"worker_processes_number",id:"worker_processes_number",level:4},{value:"worker_cpu_affinity",id:"worker_cpu_affinity",level:4},{value:"worker_priority",id:"worker_priority",level:4},{value:"worker_shutdown_timeout",id:"worker_shutdown_timeout",level:4},{value:"timer_resolution",id:"timer_resolution",level:4},{value:"daemon",id:"daemon",level:4},{value:"3.3 events \u6bb5\u6838\u5fc3\u53c2\u6570",id:"33-events-\u6bb5\u6838\u5fc3\u53c2\u6570",level:3},{value:"use",id:"use",level:4},{value:"worker_connections",id:"worker_connections",level:4},{value:"accept_mutex",id:"accept_mutex",level:4},{value:"3.4 upstream",id:"34-upstream",level:3},{value:"server",id:"server",level:4},{value:"keepalive",id:"keepalive",level:4},{value:"keepalive_requests",id:"keepalive_requests",level:4},{value:"keepalive_timeout",id:"keepalive_timeout",level:4},{value:"\u914d\u7f6e\u5b9e\u4f8b",id:"\u914d\u7f6e\u5b9e\u4f8b",level:4},{value:"\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861",id:"\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861",level:4},{value:"3.5 server\u6bb5\u6838\u5fc3\u53c2\u6570",id:"35-server\u6bb5\u6838\u5fc3\u53c2\u6570",level:3},{value:"server_name \u6307\u4ee4",id:"server_name-\u6307\u4ee4",level:4},{value:"root",id:"root",level:4},{value:"alias",id:"alias",level:4},{value:"location",id:"location",level:4},{value:"return",id:"return",level:4},{value:"rewrite",id:"rewrite",level:4},{value:"if \u6307\u4ee4",id:"if-\u6307\u4ee4",level:4},{value:"autoindex",id:"autoindex",level:4},{value:"proxy_pass",id:"proxy_pass",level:4},{value:"4. \u53d8\u91cf",id:"4-\u53d8\u91cf",level:2},{value:"5. Nginx \u5e94\u7528\u6838\u5fc3\u6982\u5ff5",id:"5-nginx-\u5e94\u7528\u6838\u5fc3\u6982\u5ff5",level:2},{value:"5.1 \u6b63\u5411\u4ee3\u7406",id:"51-\u6b63\u5411\u4ee3\u7406",level:3},{value:"5.2 \u53cd\u5411\u4ee3\u7406",id:"52-\u53cd\u5411\u4ee3\u7406",level:3},{value:"5.3 \u52a8\u9759\u5206\u79bb",id:"53-\u52a8\u9759\u5206\u79bb",level:3},{value:"5.4 \u8d1f\u8f7d\u5747\u8861",id:"54-\u8d1f\u8f7d\u5747\u8861",level:3},{value:"6. \u914d\u7f6e\u7f13\u5b58",id:"6-\u914d\u7f6e\u7f13\u5b58",level:2},{value:"proxy_cache",id:"proxy_cache",level:3},{value:"proxy_cache_path",id:"proxy_cache_path",level:3},{value:"proxy_cache_key",id:"proxy_cache_key",level:3},{value:"proxy_cache_valid",id:"proxy_cache_valid",level:3},{value:"proxy_no_cache",id:"proxy_no_cache",level:3},{value:"proxy_cache_bypass",id:"proxy_cache_bypass",level:3},{value:"upstream_cache_status \u53d8\u91cf",id:"upstream_cache_status-\u53d8\u91cf",level:3},{value:"\u914d\u7f6e\u5b9e\u4f8b",id:"\u914d\u7f6e\u5b9e\u4f8b-1",level:3},{value:"7. \u914d\u7f6eHTTPS",id:"7-\u914d\u7f6ehttps",level:2},{value:"HTTPS \u5de5\u4f5c\u6d41\u7a0b",id:"https-\u5de5\u4f5c\u6d41\u7a0b",level:3},{value:"\u914d\u7f6e\u8bc1\u4e66",id:"\u914d\u7f6e\u8bc1\u4e66",level:3},{value:"8. Nginx \u67b6\u6784",id:"8-nginx-\u67b6\u6784",level:2},{value:"\u8fdb\u7a0b\u7ed3\u6784",id:"\u8fdb\u7a0b\u7ed3\u6784",level:3},{value:"\u914d\u7f6e\u6587\u4ef6\u91cd\u8f7d\u539f\u7406",id:"\u914d\u7f6e\u6587\u4ef6\u91cd\u8f7d\u539f\u7406",level:3},{value:"Nginx \u6a21\u5757\u5316\u7ba1\u7406\u673a\u5236",id:"nginx-\u6a21\u5757\u5316\u7ba1\u7406\u673a\u5236",level:3},{value:"9. Nginx\u7684\u9ad8\u53ef\u7528",id:"9-nginx\u7684\u9ad8\u53ef\u7528",level:2},{value:"Keepalived+\u91cd\u542f\u811a\u672c+\u53cc\u673a\u70ed\u5907\u642d\u5efa",id:"keepalived\u91cd\u542f\u811a\u672c\u53cc\u673a\u70ed\u5907\u642d\u5efa",level:3},{value:"Nginx\u9ad8\u53ef\u7528\u6027\u6d4b\u8bd5",id:"nginx\u9ad8\u53ef\u7528\u6027\u6d4b\u8bd5",level:3},{value:"10. nginx\u6267\u884c\u6b65\u9aa4",id:"10-nginx\u6267\u884c\u6b65\u9aa4",level:2},{value:"11. ngx_lua \u8fd0\u884c\u6307\u4ee4",id:"11-ngx_lua-\u8fd0\u884c\u6307\u4ee4",level:2},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2}],m={toc:k},s="wrapper";function d(e){let{components:n,...i}=e;return(0,l.kt)(s,(0,a.Z)({},m,i,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"nginx\u5b66\u4e60"},"Nginx\u5b66\u4e60"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u5927\u90e8\u5206\u5185\u5bb9\u6765\u6e90\u4e8e\uff1a",(0,l.kt)("a",{parentName:"p",href:"https://juejin.cn/post/6942607113118023710"},"\u4e07\u5b57\u603b\u7ed3\uff0c\u4f53\u7cfb\u5316\u5e26\u4f60\u5168\u9762\u8ba4\u8bc6 Nginx \uff01"))),(0,l.kt)("h2",{id:"1-\u5b89\u88c5"},"1. \u5b89\u88c5"),(0,l.kt)("h3",{id:"yum\u5b89\u88c5"},"yum\u5b89\u88c5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo yum -y install nginx   # \u5b89\u88c5 nginx\n$ sudo yum remove nginx  # \u5378\u8f7d nginx\n")),(0,l.kt)("p",null,"\u4f7f\u7528 yum \u8fdb\u884c Nginx \u5b89\u88c5\u65f6\uff0cNginx \u914d\u7f6e\u6587\u4ef6\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"/etc/nginx")," \u76ee\u5f55\u4e0b\u3002\u4e5f\u901a\u8fc7 ",(0,l.kt)("inlineCode",{parentName:"p"},"rpm -ql nginx")," \u547d\u4ee4\u67e5\u770b ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u7684\u5b89\u88c5\u4fe1\u606f\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"# Nginx\u914d\u7f6e\u6587\u4ef6\n/etc/nginx/nginx.conf # nginx \u4e3b\u914d\u7f6e\u6587\u4ef6\n/etc/nginx/nginx.conf.default\n\n# \u53ef\u6267\u884c\u7a0b\u5e8f\u6587\u4ef6\n/usr/bin/nginx-upgrade\n/usr/sbin/nginx\n\n# nginx\u5e93\u6587\u4ef6\n/usr/lib/systemd/system/nginx.service # \u7528\u4e8e\u914d\u7f6e\u7cfb\u7edf\u5b88\u62a4\u8fdb\u7a0b\n/usr/lib64/nginx/modules # Nginx\u6a21\u5757\u76ee\u5f55\n\n# \u5e2e\u52a9\u6587\u6863\n/usr/share/doc/nginx-1.16.1\n/usr/share/doc/nginx-1.16.1/CHANGES\n/usr/share/doc/nginx-1.16.1/README\n/usr/share/doc/nginx-1.16.1/README.dynamic\n/usr/share/doc/nginx-1.16.1/UPGRADE-NOTES-1.6-to-1.10\n\n# \u9759\u6001\u8d44\u6e90\u76ee\u5f55\n/usr/share/nginx/html/404.html\n/usr/share/nginx/html/50x.html\n/usr/share/nginx/html/index.html\n\n# \u5b58\u653eNginx\u65e5\u5fd7\u6587\u4ef6\n/var/log/nginx\n")),(0,l.kt)("p",null,"\u4e3b\u8981\u5173\u6ce8\u7684\u6587\u4ef6\u5939\u6709\u4e24\u4e2a\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"/etc/nginx/conf.d/")," \u662f\u5b50\u914d\u7f6e\u9879\u5b58\u653e\u5904\uff0c ",(0,l.kt)("inlineCode",{parentName:"li"},"/etc/nginx/nginx.conf")," \u4e3b\u914d\u7f6e\u6587\u4ef6\u4f1a\u9ed8\u8ba4\u628a\u8fd9\u4e2a\u6587\u4ef6\u5939\u4e2d\u6240\u6709\u5b50\u914d\u7f6e\u9879\u90fd\u5f15\u5165\uff1b"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"/usr/share/nginx/html/")," \u9759\u6001\u6587\u4ef6\u90fd\u653e\u5728\u8fd9\u4e2a\u6587\u4ef6\u5939\uff0c\u4e5f\u53ef\u4ee5\u6839\u636e\u4f60\u81ea\u5df1\u7684\u4e60\u60ef\u653e\u5728\u5176\u4ed6\u5730\u65b9")),(0,l.kt)("h3",{id:"docker\u5b89\u88c5"},"docker\u5b89\u88c5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"docker run --name nginx -p 8100:80 -v D:/Code/data/nginx/nginx.conf:/etc/nginx/nginx.conf -v D:/Code/data/nginx/conf.d:/etc/nginx/conf.d -d nginx\n")),(0,l.kt)("h2",{id:"2-nginx-\u5e38\u7528\u547d\u4ee4"},"2. Nginx \u5e38\u7528\u547d\u4ee4"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"systemctl")," \u7cfb\u7edf\u547d\u4ee4\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# \u5f00\u673a\u914d\u7f6e\nsystemctl enable nginx # \u5f00\u673a\u81ea\u52a8\u542f\u52a8\nsystemctl disable nginx # \u5173\u95ed\u5f00\u673a\u81ea\u52a8\u542f\u52a8\n\n# \u542f\u52a8Nginx\nsystemctl start nginx # \u542f\u52a8Nginx\u6210\u529f\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u4e3b\u673aIP\uff0c\u6b64\u65f6\u4f1a\u5c55\u793aNginx\u9ed8\u8ba4\u9875\u9762\n\n# \u505c\u6b62Nginx\nsystemctl stop nginx\n\n# \u91cd\u542fNginx\nsystemctl restart nginx\n\n# \u91cd\u65b0\u52a0\u8f7dNginx\nsystemctl reload nginx\n\n# \u67e5\u770b Nginx \u8fd0\u884c\u72b6\u6001\nsystemctl status nginx\n\n# \u67e5\u770bNginx\u8fdb\u7a0b\nps -ef | grep nginx\n\n# \u6740\u6b7bNginx\u8fdb\u7a0b\nkill -9 pid # \u6839\u636e\u4e0a\u9762\u67e5\u770b\u5230\u7684Nginx\u8fdb\u7a0b\u53f7\uff0c\u6740\u6b7bNginx\u8fdb\u7a0b\uff0c-9 \u8868\u793a\u5f3a\u5236\u7ed3\u675f\u8fdb\u7a0b\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u5e94\u7528\u7a0b\u5e8f\u547d\u4ee4"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"nginx -s reload  # \u5411\u4e3b\u8fdb\u7a0b\u53d1\u9001\u4fe1\u53f7\uff0c\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\uff0c\u70ed\u91cd\u542f\nnginx -s reopen  # \u91cd\u542f Nginx\nnginx -s stop    # \u5feb\u901f\u5173\u95ed\nnginx -s quit    # \u7b49\u5f85\u5de5\u4f5c\u8fdb\u7a0b\u5904\u7406\u5b8c\u6210\u540e\u5173\u95ed\nnginx -T         # \u67e5\u770b\u5f53\u524d Nginx \u6700\u7ec8\u7684\u914d\u7f6e\nnginx -t         # \u68c0\u67e5\u914d\u7f6e\u662f\u5426\u6709\u95ee\u9898\n")),(0,l.kt)("h2",{id:"3-nginx-\u914d\u7f6e\u6587\u4ef6\u8be6\u89e3"},"3. Nginx \u914d\u7f6e\u6587\u4ef6\u8be6\u89e3"),(0,l.kt)("h3",{id:"31-\u4e3b\u8981\u7ed3\u6784"},"3.1 \u4e3b\u8981\u7ed3\u6784"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'# main\u6bb5\u914d\u7f6e\u4fe1\u606f\nuser  nginx;                        # \u8fd0\u884c\u7528\u6237\uff0c\u9ed8\u8ba4\u5373\u662fnginx\uff0c\u53ef\u4ee5\u4e0d\u8fdb\u884c\u8bbe\u7f6e\nworker_processes  auto;             # Nginx \u8fdb\u7a0b\u6570\uff0c\u4e00\u822c\u8bbe\u7f6e\u4e3a\u548c CPU \u6838\u6570\u4e00\u6837\nerror_log  /var/log/nginx/error.log warn;   # Nginx \u7684\u9519\u8bef\u65e5\u5fd7\u5b58\u653e\u76ee\u5f55\npid        /var/run/nginx.pid;      # Nginx \u670d\u52a1\u542f\u52a8\u65f6\u7684 pid \u5b58\u653e\u4f4d\u7f6e\n\n# events\u6bb5\u914d\u7f6e\u4fe1\u606f\nevents {\n    use epoll;     # \u4f7f\u7528epoll\u7684I/O\u6a21\u578b(\u5982\u679c\u4f60\u4e0d\u77e5\u9053Nginx\u8be5\u4f7f\u7528\u54ea\u79cd\u8f6e\u8be2\u65b9\u6cd5\uff0c\u4f1a\u81ea\u52a8\u9009\u62e9\u4e00\u4e2a\u6700\u9002\u5408\u4f60\u64cd\u4f5c\u7cfb\u7edf\u7684)\n    worker_connections 1024;   # \u6bcf\u4e2a\u8fdb\u7a0b\u5141\u8bb8\u6700\u5927\u5e76\u53d1\u6570\n}\n\n# http\u6bb5\u914d\u7f6e\u4fe1\u606f\n# \u914d\u7f6e\u4f7f\u7528\u6700\u9891\u7e41\u7684\u90e8\u5206\uff0c\u4ee3\u7406\u3001\u7f13\u5b58\u3001\u65e5\u5fd7\u5b9a\u4e49\u7b49\u7edd\u5927\u591a\u6570\u529f\u80fd\u548c\u7b2c\u4e09\u65b9\u6a21\u5757\u7684\u914d\u7f6e\u90fd\u5728\u8fd9\u91cc\u8bbe\u7f6e\nhttp { \n    # \u8bbe\u7f6e\u65e5\u5fd7\u6a21\u5f0f\n    log_format  main  \'$remote_addr - $remote_user [$time_local] "$request" \'\n                      \'$status $body_bytes_sent "$http_referer" \'\n                      \'"$http_user_agent" "$http_x_forwarded_for"\';\n\n    access_log  /var/log/nginx/access.log  main;   # Nginx\u8bbf\u95ee\u65e5\u5fd7\u5b58\u653e\u4f4d\u7f6e\n\n    sendfile            on;   # \u5f00\u542f\u9ad8\u6548\u4f20\u8f93\u6a21\u5f0f\n    tcp_nopush          on;   # \u51cf\u5c11\u7f51\u7edc\u62a5\u6587\u6bb5\u7684\u6570\u91cf\n    tcp_nodelay         on;\n    keepalive_timeout   65;   # \u4fdd\u6301\u8fde\u63a5\u7684\u65f6\u95f4\uff0c\u4e5f\u53eb\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u79d2\n    types_hash_max_size 2048;\n\n    include             /etc/nginx/mime.types;      # \u6587\u4ef6\u6269\u5c55\u540d\u4e0e\u7c7b\u578b\u6620\u5c04\u8868\n    default_type        application/octet-stream;   # \u9ed8\u8ba4\u6587\u4ef6\u7c7b\u578b\n\n    include /etc/nginx/conf.d/*.conf;   # \u52a0\u8f7d\u5b50\u914d\u7f6e\u9879\n    \n    # server\u6bb5\u914d\u7f6e\u4fe1\u606f\n    server {\n        listen       80;       # \u914d\u7f6e\u76d1\u542c\u7684\u7aef\u53e3\n        server_name  localhost;    # \u914d\u7f6e\u7684\u57df\u540d\n      \n        # location\u6bb5\u914d\u7f6e\u4fe1\u606f\n        location / {\n            root   /usr/share/nginx/html;  # \u7f51\u7ad9\u6839\u76ee\u5f55\n            index  index.html index.htm;   # \u9ed8\u8ba4\u9996\u9875\u6587\u4ef6\n            deny 172.168.22.11;   # \u7981\u6b62\u8bbf\u95ee\u7684ip\u5730\u5740\uff0c\u53ef\u4ee5\u4e3aall\n            allow 172.168.33.44\uff1b# \u5141\u8bb8\u8bbf\u95ee\u7684ip\u5730\u5740\uff0c\u53ef\u4ee5\u4e3aall\n        }\n        \n        error_page 500 502 503 504 /50x.html;  # \u9ed8\u8ba450x\u5bf9\u5e94\u7684\u8bbf\u95ee\u9875\u9762\n        error_page 400 404 error.html;   # \u540c\u4e0a\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"main")," \u5168\u5c40\u914d\u7f6e\uff0c\u5bf9\u5168\u5c40\u751f\u6548\uff1b"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"events")," \u914d\u7f6e\u5f71\u54cd ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u670d\u52a1\u5668\u4e0e\u7528\u6237\u7684\u7f51\u7edc\u8fde\u63a5\uff1b"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"http")," \u914d\u7f6e\u4ee3\u7406\uff0c\u7f13\u5b58\uff0c\u65e5\u5fd7\u5b9a\u4e49\u7b49\u7edd\u5927\u591a\u6570\u529f\u80fd\u548c\u7b2c\u4e09\u65b9\u6a21\u5757\u7684\u914d\u7f6e\uff1b"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"server")," \u914d\u7f6e\u865a\u62df\u4e3b\u673a\u7684\u76f8\u5173\u53c2\u6570\uff0c\u4e00\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},"http")," \u5757\u4e2d\u53ef\u4ee5\u6709\u591a\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},"server")," \u5757\uff1b"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"location")," \u7528\u4e8e\u914d\u7f6e\u5339\u914d\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"uri")," \uff1b"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"upstream")," \u914d\u7f6e\u540e\u7aef\u670d\u52a1\u5668\u5177\u4f53\u5730\u5740\uff0c\u8d1f\u8f7d\u5747\u8861\u914d\u7f6e\u4e0d\u53ef\u6216\u7f3a\u7684\u90e8\u5206\uff1b"),(0,l.kt)("p",null,"\u4e0b\u56fe\u80fd\u6e05\u6670\u7684\u5c55\u793a\u5b83\u7684\u5c42\u7ea7\u7ed3\u6784\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/87fffe0360aa4f34adb6258a955aad38~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:"\u672a\u547d\u540d\u6587\u4ef6 (4).png"})),(0,l.kt)("h3",{id:"32-main-\u6bb5\u6838\u5fc3\u53c2\u6570"},"3.2 main \u6bb5\u6838\u5fc3\u53c2\u6570"),(0,l.kt)("h4",{id:"user"},"user"),(0,l.kt)("p",null,"\u6307\u5b9a\u8fd0\u884c ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"woker")," \u5b50\u8fdb\u7a0b\u7684\u5c5e\u4e3b\u548c\u5c5e\u7ec4\uff0c\u5176\u4e2d\u7ec4\u53ef\u4ee5\u4e0d\u6307\u5b9a\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"user USERNAME [GROUP]\n\nuser nginx lion; # \u7528\u6237\u662fnginx;\u7ec4\u662flion\n\n")),(0,l.kt)("h4",{id:"pid"},"pid"),(0,l.kt)("p",null,"\u6307\u5b9a\u8fd0\u884c ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," ",(0,l.kt)("inlineCode",{parentName:"p"},"master")," \u4e3b\u8fdb\u7a0b\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"pid")," \u6587\u4ef6\u5b58\u653e\u8def\u5f84\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"pid /opt/nginx/logs/nginx.pid # master\u4e3b\u8fdb\u7a0b\u7684\u7684pid\u5b58\u653e\u5728nginx.pid\u7684\u6587\u4ef6\n\n")),(0,l.kt)("h4",{id:"worker_rlimit_nofile_number"},"worker_rlimit_nofile_number"),(0,l.kt)("p",null,"\u6307\u5b9a ",(0,l.kt)("inlineCode",{parentName:"p"},"worker")," \u5b50\u8fdb\u7a0b\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u53e5\u67c4\u6570\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"worker_rlimit_nofile 20480; # \u53ef\u4ee5\u7406\u89e3\u6210\u6bcf\u4e2aworker\u5b50\u8fdb\u7a0b\u7684\u6700\u5927\u8fde\u63a5\u6570\u91cf\u3002\n\n")),(0,l.kt)("h4",{id:"worker_rlimit_core"},"worker_rlimit_core"),(0,l.kt)("p",null,"\u6307\u5b9a ",(0,l.kt)("inlineCode",{parentName:"p"},"worker")," \u5b50\u8fdb\u7a0b\u5f02\u5e38\u7ec8\u6b62\u540e\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"core")," \u6587\u4ef6\uff0c\u7528\u4e8e\u8bb0\u5f55\u5206\u6790\u95ee\u9898\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"worker_rlimit_core 50M; # \u5b58\u653e\u5927\u5c0f\u9650\u5236\nworking_directory /opt/nginx/tmp; # \u5b58\u653e\u76ee\u5f55\n\n")),(0,l.kt)("h4",{id:"worker_processes_number"},"worker_processes_number"),(0,l.kt)("p",null,"\u6307\u5b9a ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u542f\u52a8\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"worker")," \u5b50\u8fdb\u7a0b\u6570\u91cf\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"worker_processes 4; # \u6307\u5b9a\u5177\u4f53\u5b50\u8fdb\u7a0b\u6570\u91cf\nworker_processes auto; # \u4e0e\u5f53\u524dcpu\u7269\u7406\u6838\u5fc3\u6570\u4e00\u81f4\n\n")),(0,l.kt)("h4",{id:"worker_cpu_affinity"},"worker_cpu_affinity"),(0,l.kt)("p",null,"\u5c06\u6bcf\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},"worker")," \u5b50\u8fdb\u7a0b\u4e0e\u6211\u4eec\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"cpu")," \u7269\u7406\u6838\u5fc3\u7ed1\u5b9a\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"worker_cpu_affinity 0001 0010 0100 1000; # 4\u4e2a\u7269\u7406\u6838\u5fc3\uff0c4\u4e2aworker\u5b50\u8fdb\u7a0b\n\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e3c23de61deb4c6391fe70e561f18aa3~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:"\u672a\u547d\u540d\u6587\u4ef6 (1).png"})),(0,l.kt)("p",null,"\u5c06\u6bcf\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},"worker")," \u5b50\u8fdb\u7a0b\u4e0e\u7279\u5b9a ",(0,l.kt)("inlineCode",{parentName:"p"},"CPU")," \u7269\u7406\u6838\u5fc3\u7ed1\u5b9a\uff0c\u4f18\u52bf\u5728\u4e8e\uff0c\u907f\u514d\u540c\u4e00\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},"worker")," \u5b50\u8fdb\u7a0b\u5728\u4e0d\u540c\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"CPU")," \u6838\u5fc3\u4e0a\u5207\u6362\uff0c\u7f13\u5b58\u5931\u6548\uff0c\u964d\u4f4e\u6027\u80fd\u3002\u4f46\u5176\u5e76\u4e0d\u80fd\u771f\u6b63\u7684\u907f\u514d\u8fdb\u7a0b\u5207\u6362\u3002"),(0,l.kt)("h4",{id:"worker_priority"},"worker_priority"),(0,l.kt)("p",null,"\u6307\u5b9a ",(0,l.kt)("inlineCode",{parentName:"p"},"worker")," \u5b50\u8fdb\u7a0b\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"nice")," \u503c\uff0c\u4ee5\u8c03\u6574\u8fd0\u884c ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u7684\u4f18\u5148\u7ea7\uff0c\u901a\u5e38\u8bbe\u5b9a\u4e3a\u8d1f\u503c\uff0c\u4ee5\u4f18\u5148\u8c03\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"worker_priority -10; # 120-10=110\uff0c110\u5c31\u662f\u6700\u7ec8\u7684\u4f18\u5148\u7ea7\n\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Linux")," \u9ed8\u8ba4\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\u503c\u662f120\uff0c\u503c\u8d8a\u5c0f\u8d8a\u4f18\u5148\uff1b ",(0,l.kt)("inlineCode",{parentName:"p"},"nice")," \u5b9a\u8303\u56f4\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"-20")," \u5230 ",(0,l.kt)("inlineCode",{parentName:"p"},"+19")," \u3002"),(0,l.kt)("p",null,"[\u5907\u6ce8]"," \u5e94\u7528\u7684\u9ed8\u8ba4\u4f18\u5148\u7ea7\u503c\u662f120\u52a0\u4e0a ",(0,l.kt)("inlineCode",{parentName:"p"},"nice")," \u503c\u7b49\u4e8e\u5b83\u6700\u7ec8\u7684\u503c\uff0c\u8fd9\u4e2a\u503c\u8d8a\u5c0f\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\u3002"),(0,l.kt)("h4",{id:"worker_shutdown_timeout"},"worker_shutdown_timeout"),(0,l.kt)("p",null,"\u6307\u5b9a ",(0,l.kt)("inlineCode",{parentName:"p"},"worker")," \u5b50\u8fdb\u7a0b\u4f18\u96c5\u9000\u51fa\u65f6\u7684\u8d85\u65f6\u65f6\u95f4\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"worker_shutdown_timeout 5s;\n\n")),(0,l.kt)("h4",{id:"timer_resolution"},"timer_resolution"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"worker")," \u5b50\u8fdb\u7a0b\u5185\u90e8\u4f7f\u7528\u7684\u8ba1\u65f6\u5668\u7cbe\u5ea6\uff0c\u8c03\u6574\u65f6\u95f4\u95f4\u9694\u8d8a\u5927\uff0c\u7cfb\u7edf\u8c03\u7528\u8d8a\u5c11\uff0c\u6709\u5229\u4e8e\u6027\u80fd\u63d0\u5347\uff1b\u53cd\u4e4b\uff0c\u7cfb\u7edf\u8c03\u7528\u8d8a\u591a\uff0c\u6027\u80fd\u4e0b\u964d\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"timer_resolution 100ms;\n\n")),(0,l.kt)("p",null,"\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"Linux")," \u7cfb\u7edf\u4e2d\uff0c\u7528\u6237\u9700\u8981\u83b7\u53d6\u8ba1\u65f6\u5668\u65f6\u9700\u8981\u5411\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u53d1\u9001\u8bf7\u6c42\uff0c\u6709\u8bf7\u6c42\u5c31\u5fc5\u7136\u4f1a\u6709\u5f00\u9500\uff0c\u56e0\u6b64\u8fd9\u4e2a\u95f4\u9694\u8d8a\u5927\u5f00\u9500\u5c31\u8d8a\u5c0f\u3002"),(0,l.kt)("h4",{id:"daemon"},"daemon"),(0,l.kt)("p",null,"\u6307\u5b9a ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u7684\u8fd0\u884c\u65b9\u5f0f\uff0c\u524d\u53f0\u8fd8\u662f\u540e\u53f0\uff0c\u524d\u53f0\u7528\u4e8e\u8c03\u8bd5\uff0c\u540e\u53f0\u7528\u4e8e\u751f\u4ea7\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"daemon off; # \u9ed8\u8ba4\u662fon\uff0c\u540e\u53f0\u8fd0\u884c\u6a21\u5f0f\n")),(0,l.kt)("h3",{id:"33-events-\u6bb5\u6838\u5fc3\u53c2\u6570"},"3.3 events \u6bb5\u6838\u5fc3\u53c2\u6570"),(0,l.kt)("h4",{id:"use"},"use"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u4f7f\u7528\u4f55\u79cd\u4e8b\u4ef6\u9a71\u52a8\u6a21\u578b\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"use method; # \u4e0d\u63a8\u8350\u914d\u7f6e\u5b83\uff0c\u8ba9nginx\u81ea\u5df1\u9009\u62e9\n\nmethod \u53ef\u9009\u503c\u4e3a\uff1aselect\u3001poll\u3001kqueue\u3001epoll\u3001/dev/poll\u3001eventport\n\n")),(0,l.kt)("h4",{id:"worker_connections"},"worker_connections"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"worker")," \u5b50\u8fdb\u7a0b\u80fd\u591f\u5904\u7406\u7684\u6700\u5927\u5e76\u53d1\u8fde\u63a5\u6570\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"worker_connections 1024 # \u6bcf\u4e2a\u5b50\u8fdb\u7a0b\u7684\u6700\u5927\u8fde\u63a5\u6570\u4e3a1024\n\n")),(0,l.kt)("h4",{id:"accept_mutex"},"accept_mutex"),(0,l.kt)("p",null,"\u662f\u5426\u6253\u5f00\u8d1f\u8f7d\u5747\u8861\u4e92\u65a5\u9501\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"accept_mutex on # \u9ed8\u8ba4\u662foff\u5173\u95ed\u7684\uff0c\u8fd9\u91cc\u63a8\u8350\u6253\u5f00\n")),(0,l.kt)("h3",{id:"34-upstream"},"3.4 upstream"),(0,l.kt)("p",null,"\u7528\u4e8e\u5b9a\u4e49\u4e0a\u6e38\u670d\u52a1\u5668\uff08\u6307\u7684\u5c31\u662f\u540e\u53f0\u63d0\u4f9b\u7684\u5e94\u7528\u670d\u52a1\u5668\uff09\u7684\u76f8\u5173\u4fe1\u606f\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a8e5089117234f529180c8720922c2fc~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:"\u672a\u547d\u540d\u6587\u4ef6 (2).png"})),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1aupstream name {\n    ...\n}\n\n\u4e0a\u4e0b\u6587\uff1ahttp\n\n\u793a\u4f8b\uff1a\nupstream back_end_server{\n  server 192.168.100.33:8081\n}\n\n")),(0,l.kt)("p",null,"\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"upstream")," \u5185\u53ef\u4f7f\u7528\u7684\u6307\u4ee4\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"server")," \u5b9a\u4e49\u4e0a\u6e38\u670d\u52a1\u5668\u5730\u5740\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"zone")," \u5b9a\u4e49\u5171\u4eab\u5185\u5b58\uff0c\u7528\u4e8e\u8de8 ",(0,l.kt)("inlineCode",{parentName:"li"},"worker")," \u5b50\u8fdb\u7a0b\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"keepalive")," \u5bf9\u4e0a\u6e38\u670d\u52a1\u542f\u7528\u957f\u8fde\u63a5\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"keepalive_requests")," \u4e00\u4e2a\u957f\u8fde\u63a5\u6700\u591a\u8bf7\u6c42 ",(0,l.kt)("inlineCode",{parentName:"li"},"HTTP")," \u7684\u4e2a\u6570\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"keepalive_timeout")," \u7a7a\u95f2\u60c5\u5f62\u4e0b\uff0c\u4e00\u4e2a\u957f\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u957f\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"hash")," \u54c8\u5e0c\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"ip_hash")," \u4f9d\u636e ",(0,l.kt)("inlineCode",{parentName:"li"},"IP")," \u8fdb\u884c\u54c8\u5e0c\u8ba1\u7b97\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"least_conn")," \u6700\u5c11\u8fde\u63a5\u6570\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"least_time")," \u6700\u77ed\u54cd\u5e94\u65f6\u95f4\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"random")," \u968f\u673a\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff1b")),(0,l.kt)("h4",{id:"server"},"server"),(0,l.kt)("p",null,"\u5b9a\u4e49\u4e0a\u6e38\u670d\u52a1\u5668\u5730\u5740\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1aserver address [parameters]\n\n\u4e0a\u4e0b\u6587\uff1aupstream\n\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"parameters")," \u53ef\u9009\u503c\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"weight=number")," \u6743\u91cd\u503c\uff0c\u9ed8\u8ba4\u4e3a1\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"max_conns=number")," \u4e0a\u6e38\u670d\u52a1\u5668\u7684\u6700\u5927\u5e76\u53d1\u8fde\u63a5\u6570\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"fail_timeout=time")," \u670d\u52a1\u5668\u4e0d\u53ef\u7528\u7684\u5224\u5b9a\u65f6\u95f4\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"max_fails=numer")," \u670d\u52a1\u5668\u4e0d\u53ef\u7528\u7684\u68c0\u67e5\u6b21\u6570\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"backup")," \u5907\u4efd\u670d\u52a1\u5668\uff0c\u4ec5\u5f53\u5176\u4ed6\u670d\u52a1\u5668\u90fd\u4e0d\u53ef\u7528\u65f6\u624d\u4f1a\u542f\u7528\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"down")," \u6807\u8bb0\u670d\u52a1\u5668\u957f\u671f\u4e0d\u53ef\u7528\uff0c\u79bb\u7ebf\u7ef4\u62a4\uff1b")),(0,l.kt)("h4",{id:"keepalive"},"keepalive"),(0,l.kt)("p",null,"\u9650\u5236\u6bcf\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},"worker")," \u5b50\u8fdb\u7a0b\u4e0e\u4e0a\u6e38\u670d\u52a1\u5668\u7a7a\u95f2\u957f\u8fde\u63a5\u7684\u6700\u5927\u6570\u91cf\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"keepalive connections;\n\n\u4e0a\u4e0b\u6587\uff1aupstream\n\n\u793a\u4f8b\uff1akeepalive 16;\n\n")),(0,l.kt)("h4",{id:"keepalive_requests"},"keepalive_requests"),(0,l.kt)("p",null,"\u5355\u4e2a\u957f\u8fde\u63a5\u53ef\u4ee5\u5904\u7406\u7684\u6700\u591a ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTP")," \u8bf7\u6c42\u4e2a\u6570\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1akeepalive_requests number;\n\n\u9ed8\u8ba4\u503c\uff1akeepalive_requests 100;\n\n\u4e0a\u4e0b\u6587\uff1aupstream\n\n")),(0,l.kt)("h4",{id:"keepalive_timeout"},"keepalive_timeout"),(0,l.kt)("p",null,"\u7a7a\u95f2\u957f\u8fde\u63a5\u7684\u6700\u957f\u4fdd\u6301\u65f6\u95f4\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1akeepalive_timeout time;\n\n\u9ed8\u8ba4\u503c\uff1akeepalive_timeout 60s;\n\n\u4e0a\u4e0b\u6587\uff1aupstream\n\n")),(0,l.kt)("h4",{id:"\u914d\u7f6e\u5b9e\u4f8b"},"\u914d\u7f6e\u5b9e\u4f8b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"upstream back_end{\n    server 127.0.0.1:8081 weight=3 max_conns=1000 fail_timeout=10s max_fails=2;\n  keepalive 32;\n  keepalive_requests 50;\n  keepalive_timeout 30s;\n}\n")),(0,l.kt)("h4",{id:"\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861"},"\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861"),(0,l.kt)("p",null,"\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861\u4e3b\u8981\u662f\u8981\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"upstream")," \u6307\u4ee4\u3002\u9ed8\u8ba4\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\u4e3a\u8f6e\u8be2\u7b56\u7565\u3002\u8fd8\u6709\u5176\u5b83\u5206\u53d1\u7b56\u7565\u5982\u4e0b\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"hash \u7b97\u6cd5")),(0,l.kt)("p",null,"\u901a\u8fc7\u5236\u5b9a\u5173\u952e\u5b57\u4f5c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"hash key")," \uff0c\u57fa\u4e8e ",(0,l.kt)("inlineCode",{parentName:"p"},"hash")," \u7b97\u6cd5\u6620\u5c04\u5230\u7279\u5b9a\u7684\u4e0a\u6e38\u670d\u52a1\u5668\u4e2d\u3002\u5173\u952e\u5b57\u53ef\u4ee5\u5305\u542b\u6709\u53d8\u91cf\u3001\u5b57\u7b26\u4e32\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"upstream demo_server {\n  hash $request_uri;\n  server 121.42.11.34:8020;\n  server 121.42.11.34:8030;\n  server 121.42.11.34:8040;\n}\n\nserver {\n  listen 80;\n  server_name balance.lion.club;\n  \n  location /balance/ {\n    proxy_pass http://demo_server;\n  }\n}\n\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"hash $request_uri")," \u8868\u793a\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"request_uri")," \u53d8\u91cf\u4f5c\u4e3a ",(0,l.kt)("inlineCode",{parentName:"p"},"hash")," \u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"key")," \u503c\uff0c\u53ea\u8981\u8bbf\u95ee\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"URI")," \u4fdd\u6301\u4e0d\u53d8\uff0c\u5c31\u4f1a\u4e00\u76f4\u5206\u53d1\u7ed9\u540c\u4e00\u53f0\u670d\u52a1\u5668\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"ip_hash")),(0,l.kt)("p",null,"\u6839\u636e\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42 ",(0,l.kt)("inlineCode",{parentName:"p"},"ip")," \u8fdb\u884c\u5224\u65ad\uff0c\u53ea\u8981 ",(0,l.kt)("inlineCode",{parentName:"p"},"ip")," \u5730\u5740\u4e0d\u53d8\u5c31\u6c38\u8fdc\u5206\u914d\u5230\u540c\u4e00\u53f0\u4e3b\u673a\u3002\u5b83\u53ef\u4ee5\u6709\u6548\u89e3\u51b3\u540e\u53f0\u670d\u52a1\u5668 ",(0,l.kt)("inlineCode",{parentName:"p"},"session")," \u4fdd\u6301\u7684\u95ee\u9898\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"upstream demo_server {\n  ip_hash;\n  server 121.42.11.34:8020;\n  server 121.42.11.34:8030;\n  server 121.42.11.34:8040;\n}\n\nserver {\n  listen 80;\n  server_name balance.lion.club;\n  \n  location /balance/ {\n    proxy_pass http://demo_server;\n  }\n}\n\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6700\u5c11\u8fde\u63a5\u6570\u7b97\u6cd5")),(0,l.kt)("p",null,"\u5404\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},"worker")," \u5b50\u8fdb\u7a0b\u901a\u8fc7\u8bfb\u53d6\u5171\u4eab\u5185\u5b58\u7684\u6570\u636e\uff0c\u6765\u83b7\u53d6\u540e\u7aef\u670d\u52a1\u5668\u7684\u4fe1\u606f\u3002\u6765\u6311\u9009\u4e00\u53f0\u5f53\u524d\u5df2\u5efa\u7acb\u8fde\u63a5\u6570\u6700\u5c11\u7684\u670d\u52a1\u5668\u8fdb\u884c\u5206\u914d\u8bf7\u6c42\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1aleast_conn;\n\n\u4e0a\u4e0b\u6587\uff1aupstream;\n\n")),(0,l.kt)("p",null,"\u793a\u4f8b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"upstream demo_server {\n  zone test 10M; # zone\u53ef\u4ee5\u8bbe\u7f6e\u5171\u4eab\u5185\u5b58\u7a7a\u95f4\u7684\u540d\u5b57\u548c\u5927\u5c0f\n  least_conn;\n  server 121.42.11.34:8020;\n  server 121.42.11.34:8030;\n  server 121.42.11.34:8040;\n}\n\nserver {\n  listen 80;\n  server_name balance.lion.club;\n  \n  location /balance/ {\n    proxy_pass http://demo_server;\n  }\n}\n")),(0,l.kt)("h3",{id:"35-server\u6bb5\u6838\u5fc3\u53c2\u6570"},"3.5 server\u6bb5\u6838\u5fc3\u53c2\u6570"),(0,l.kt)("h4",{id:"server_name-\u6307\u4ee4"},"server_name \u6307\u4ee4"),(0,l.kt)("p",null,"\u6307\u5b9a\u865a\u62df\u4e3b\u673a\u57df\u540d\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"server_name name1 name2 name3\n\n# \u793a\u4f8b\uff1a\nserver_name www.nginx.com;\n\n")),(0,l.kt)("p",null,"\u57df\u540d\u5339\u914d\u7684\u56db\u79cd\u5199\u6cd5\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u7cbe\u786e\u5339\u914d\uff1a ",(0,l.kt)("inlineCode",{parentName:"li"},"server_name www.nginx.com")," ;"),(0,l.kt)("li",{parentName:"ul"},"\u5de6\u4fa7\u901a\u914d\uff1a ",(0,l.kt)("inlineCode",{parentName:"li"},"server_name *.nginx.com")," ;"),(0,l.kt)("li",{parentName:"ul"},"\u53f3\u4fa7\u7edf\u914d\uff1a ",(0,l.kt)("inlineCode",{parentName:"li"},"server_name  www.nginx.*")," ;"),(0,l.kt)("li",{parentName:"ul"},"\u6b63\u5219\u5339\u914d\uff1a ",(0,l.kt)("inlineCode",{parentName:"li"},"server_name ~^www\\.nginx\\.*$")," ;")),(0,l.kt)("p",null,"\u5339\u914d\u4f18\u5148\u7ea7\uff1a",(0,l.kt)("strong",{parentName:"p"},"\u7cbe\u786e\u5339\u914d > \u5de6\u4fa7\u901a\u914d\u7b26\u5339\u914d > \u53f3\u4fa7\u901a\u914d\u7b26\u5339\u914d > \u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"server_name")," \u914d\u7f6e\u5b9e\u4f8b\uff1a"),(0,l.kt)("p",null,"1\u3001\u914d\u7f6e\u672c\u5730  ",(0,l.kt)("inlineCode",{parentName:"p"},"DNS")," \u89e3\u6790 ",(0,l.kt)("inlineCode",{parentName:"p"},"vim /etc/hosts")," \uff08 ",(0,l.kt)("inlineCode",{parentName:"p"},"macOS")," \u7cfb\u7edf\uff09"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# \u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9\uff0c\u5176\u4e2d 121.42.11.34 \u662f\u963f\u91cc\u4e91\u670d\u52a1\u5668IP\u5730\u5740\n121.42.11.34 www.nginx-test.com\n121.42.11.34 mail.nginx-test.com\n121.42.11.34 www.nginx-test.org\n121.42.11.34 doc.nginx-test.com\n121.42.11.34 www.nginx-test.cn\n121.42.11.34 fe.nginx-test.club\n\n")),(0,l.kt)("p",null,"[\u6ce8\u610f]"," \u8fd9\u91cc\u4f7f\u7528\u7684\u662f\u865a\u62df\u57df\u540d\u8fdb\u884c\u6d4b\u8bd5\uff0c\u56e0\u6b64\u9700\u8981\u914d\u7f6e\u672c\u5730 ",(0,l.kt)("inlineCode",{parentName:"p"},"DNS")," \u89e3\u6790\uff0c\u5982\u679c\u4f7f\u7528\u963f\u91cc\u4e91\u4e0a\u8d2d\u4e70\u7684\u57df\u540d\uff0c\u5219\u9700\u8981\u5728\u963f\u91cc\u4e91\u4e0a\u8bbe\u7f6e\u597d\u57df\u540d\u89e3\u6790\u3002"),(0,l.kt)("p",null,"2\u3001\u914d\u7f6e\u963f\u91cc\u4e91 ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"vim /etc/nginx/nginx.conf")," "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# \u8fd9\u91cc\u53ea\u5217\u4e3e\u4e86http\u7aef\u4e2d\u7684sever\u7aef\u914d\u7f6e\n\n# \u5de6\u5339\u914d\nserver {\n    listen  80;\n    server_name *.nginx-test.com;\n    root    /usr/share/nginx/html/nginx-test/left-match/;\n    location / {\n        index index.html;\n    }\n}\n\n# \u6b63\u5219\u5339\u914d\nserver {\n    listen  80;\n    server_name ~^.*\\.nginx-test\\..*$;\n    root    /usr/share/nginx/html/nginx-test/reg-match/;\n    location / {\n        index index.html;\n    }\n}\n\n# \u53f3\u5339\u914d\nserver {\n    listen  80;\n    server_name www.nginx-test.*;\n    root    /usr/share/nginx/html/nginx-test/right-match/;\n    location / {\n        index index.html;\n    }\n}\n\n# \u5b8c\u5168\u5339\u914d\nserver {\n    listen  80;\n    server_name www.nginx-test.com;\n    root    /usr/share/nginx/html/nginx-test/all-match/;\n    location / {\n        index index.html;\n    }\n}\n\n")),(0,l.kt)("p",null,"3\u3001\u8bbf\u95ee\u5206\u6790"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5f53\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"li"},"www.nginx-test.com")," \u65f6\uff0c\u90fd\u53ef\u4ee5\u88ab\u5339\u914d\u4e0a\uff0c\u56e0\u6b64\u9009\u62e9\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u201c\u5b8c\u5168\u5339\u914d\u201d\uff1b"),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"li"},"mail.nginx-test.com")," \u65f6\uff0c\u4f1a\u8fdb\u884c\u201c\u5de6\u5339\u914d\u201d\uff1b"),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"li"},"www.nginx-test.org")," \u65f6\uff0c\u4f1a\u8fdb\u884c\u201c\u53f3\u5339\u914d\u201d\uff1b"),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"li"},"doc.nginx-test.com")," \u65f6\uff0c\u4f1a\u8fdb\u884c\u201c\u5de6\u5339\u914d\u201d\uff1b"),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"li"},"www.nginx-test.cn")," \u65f6\uff0c\u4f1a\u8fdb\u884c\u201c\u53f3\u5339\u914d\u201d\uff1b"),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"li"},"fe.nginx-test.club")," \u65f6\uff0c\u4f1a\u8fdb\u884c\u201c\u6b63\u5219\u5339\u914d\u201d\uff1b")),(0,l.kt)("h4",{id:"root"},"root"),(0,l.kt)("p",null,"\u6307\u5b9a\u9759\u6001\u8d44\u6e90\u76ee\u5f55\u4f4d\u7f6e\uff0c\u5b83\u53ef\u4ee5\u5199\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"http")," \u3001 ",(0,l.kt)("inlineCode",{parentName:"p"},"server")," \u3001 ",(0,l.kt)("inlineCode",{parentName:"p"},"location")," \u7b49\u914d\u7f6e\u4e2d\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"root path\n\n\u4f8b\u5982\uff1a\nlocation /image {\n    root /opt/nginx/static;\n}\n\n\u5f53\u7528\u6237\u8bbf\u95ee www.test.com/image/1.png \u65f6\uff0c\u5b9e\u9645\u5728\u670d\u52a1\u5668\u627e\u7684\u8def\u5f84\u662f /opt/nginx/static/image/1.png\n\n")),(0,l.kt)("p",null,"[\u6ce8\u610f]"," ",(0,l.kt)("inlineCode",{parentName:"p"},"root")," \u4f1a\u5c06\u5b9a\u4e49\u8def\u5f84\u4e0e ",(0,l.kt)("inlineCode",{parentName:"p"},"URI")," \u53e0\u52a0\uff0c ",(0,l.kt)("inlineCode",{parentName:"p"},"alias")," \u5219\u53ea\u53d6\u5b9a\u4e49\u8def\u5f84\u3002"),(0,l.kt)("h4",{id:"alias"},"alias"),(0,l.kt)("p",null,"\u5b83\u4e5f\u662f\u6307\u5b9a\u9759\u6001\u8d44\u6e90\u76ee\u5f55\u4f4d\u7f6e\uff0c\u5b83\u53ea\u80fd\u5199\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"location")," \u4e2d\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"location /image {\n    alias /opt/nginx/static/image/;\n}\n\n\u5f53\u7528\u6237\u8bbf\u95ee www.test.com/image/1.png \u65f6\uff0c\u5b9e\u9645\u5728\u670d\u52a1\u5668\u627e\u7684\u8def\u5f84\u662f /opt/nginx/static/image/1.png\n\n")),(0,l.kt)("p",null,"[\u6ce8\u610f]"," \u4f7f\u7528 alias \u672b\u5c3e\u4e00\u5b9a\u8981\u6dfb\u52a0 ",(0,l.kt)("inlineCode",{parentName:"p"},"/")," \uff0c\u5e76\u4e14\u5b83\u53ea\u80fd\u4f4d\u4e8e ",(0,l.kt)("inlineCode",{parentName:"p"},"location")," \u4e2d\u3002"),(0,l.kt)("h4",{id:"location"},"location"),(0,l.kt)("p",null,"\u914d\u7f6e\u8def\u5f84\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"location [ = | ~ | ~* | ^~ ] uri {\n    ...\n}\n\n")),(0,l.kt)("p",null,"\u5339\u914d\u89c4\u5219\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"=")," \u7cbe\u786e\u5339\u914d\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"~")," \u6b63\u5219\u5339\u914d\uff0c\u533a\u5206\u5927\u5c0f\u5199\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"~*")," \u6b63\u5219\u5339\u914d\uff0c\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"^~")," \u5339\u914d\u5230\u5373\u505c\u6b62\u641c\u7d22\uff1b")),(0,l.kt)("p",null,"\u5339\u914d\u4f18\u5148\u7ea7\uff1a ",(0,l.kt)("inlineCode",{parentName:"p"},"=")," > ",(0,l.kt)("inlineCode",{parentName:"p"},"^~")," >  ",(0,l.kt)("inlineCode",{parentName:"p"},"~")," > ",(0,l.kt)("inlineCode",{parentName:"p"},"~*")," > \u4e0d\u5e26\u4efb\u4f55\u5b57\u7b26\u3002"),(0,l.kt)("p",null,"\u5b9e\u4f8b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"server {\n  listen    80;\n  server_name   www.nginx-test.com;\n  \n  # \u53ea\u6709\u5f53\u8bbf\u95ee www.nginx-test.com/match_all/ \u65f6\u624d\u4f1a\u5339\u914d\u5230/usr/share/nginx/html/match_all/index.html\n  location = /match_all/ {\n      root  /usr/share/nginx/html\n      index index.html\n  }\n  \n  # \u5f53\u8bbf\u95ee www.nginx-test.com/1.jpg \u7b49\u8def\u5f84\u65f6\u4f1a\u53bb /usr/share/nginx/images/1.jpg \u627e\u5bf9\u5e94\u7684\u8d44\u6e90\n  location ~ \\.(jpeg|jpg|png|svg)$ {\n    root /usr/share/nginx/images;\n  }\n  \n  # \u5f53\u8bbf\u95ee www.nginx-test.com/bbs/ \u65f6\u4f1a\u5339\u914d\u4e0a /usr/share/nginx/html/bbs/index.html\n  location ^~ /bbs/ {\n    root /usr/share/nginx/html;\n    index index.html index.htm;\n  }\n}\n\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"location \u4e2d\u7684\u53cd\u659c\u7ebf")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"location /test {\n    ...\n}\n\nlocation /test/ {\n    ...\n}\n\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u4e0d\u5e26 ",(0,l.kt)("inlineCode",{parentName:"li"},"/")," \u5f53\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"li"},"www.nginx-test.com/test")," \u65f6\uff0c ",(0,l.kt)("inlineCode",{parentName:"li"},"Nginx")," \u5148\u627e\u662f\u5426\u6709 ",(0,l.kt)("inlineCode",{parentName:"li"},"test")," \u76ee\u5f55\uff0c\u5982\u679c\u6709\u5219\u627e ",(0,l.kt)("inlineCode",{parentName:"li"},"test")," \u76ee\u5f55\u4e0b\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"index.html")," \uff1b\u5982\u679c\u6ca1\u6709 ",(0,l.kt)("inlineCode",{parentName:"li"},"test")," \u76ee\u5f55\uff0c ",(0,l.kt)("inlineCode",{parentName:"li"},"nginx")," \u5219\u4f1a\u627e\u662f\u5426\u6709 ",(0,l.kt)("inlineCode",{parentName:"li"},"test")," \u6587\u4ef6\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5e26 ",(0,l.kt)("inlineCode",{parentName:"li"},"/")," \u5f53\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"li"},"www.nginx-test.com/test")," \u65f6\uff0c ",(0,l.kt)("inlineCode",{parentName:"li"},"Nginx")," \u5148\u627e\u662f\u5426\u6709 ",(0,l.kt)("inlineCode",{parentName:"li"},"test")," \u76ee\u5f55\uff0c\u5982\u679c\u6709\u5219\u627e ",(0,l.kt)("inlineCode",{parentName:"li"},"test")," \u76ee\u5f55\u4e0b\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"index.html")," \uff0c\u5982\u679c\u6ca1\u6709\u5b83\u4e5f\u4e0d\u4f1a\u53bb\u627e\u662f\u5426\u5b58\u5728 ",(0,l.kt)("inlineCode",{parentName:"li"},"test")," \u6587\u4ef6\u3002")),(0,l.kt)("h4",{id:"return"},"return"),(0,l.kt)("p",null,"\u505c\u6b62\u5904\u7406\u8bf7\u6c42\uff0c\u76f4\u63a5\u8fd4\u56de\u54cd\u5e94\u7801\u6216\u91cd\u5b9a\u5411\u5230\u5176\u4ed6 ",(0,l.kt)("inlineCode",{parentName:"p"},"URL")," \uff1b\u6267\u884c ",(0,l.kt)("inlineCode",{parentName:"p"},"return")," \u6307\u4ee4\u540e\uff0c ",(0,l.kt)("inlineCode",{parentName:"p"},"location")," \u4e2d\u540e\u7eed\u6307\u4ee4\u5c06\u4e0d\u4f1a\u88ab\u6267\u884c\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'return code [text];\nreturn code URL;\nreturn URL;\n\n\u4f8b\u5982\uff1a\nlocation / {\n    return 404; # \u76f4\u63a5\u8fd4\u56de\u72b6\u6001\u7801\n}\n\nlocation / {\n    return 404 "pages not found"; # \u8fd4\u56de\u72b6\u6001\u7801 + \u4e00\u6bb5\u6587\u672c\n}\n\nlocation / {\n    return 302 /bbs ; # \u8fd4\u56de\u72b6\u6001\u7801 + \u91cd\u5b9a\u5411\u5730\u5740\n}\n\nlocation / {\n    return https://www.baidu.com ; # \u8fd4\u56de\u91cd\u5b9a\u5411\u5730\u5740\n}\n\n')),(0,l.kt)("h4",{id:"rewrite"},"rewrite"),(0,l.kt)("p",null,"\u6839\u636e\u6307\u5b9a\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u89c4\u5219\uff0c\u91cd\u5199 ",(0,l.kt)("inlineCode",{parentName:"p"},"URL")," \u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1arewrite \u6b63\u5219\u8868\u8fbe\u5f0f \u8981\u66ff\u6362\u7684\u5185\u5bb9 [flag];\n\n\u4e0a\u4e0b\u6587\uff1aserver\u3001location\u3001if\n\n\u793a\u4f8b\uff1arewirte /images/(.*\\.jpg)$ /pic/$1; # $1\u662f\u524d\u9762\u62ec\u53f7(.*\\.jpg)\u7684\u53cd\u5411\u5f15\u7528\n\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"flag")," \u53ef\u9009\u503c\u7684\u542b\u4e49\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"last")," \u91cd\u5199\u540e\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \u53d1\u8d77\u65b0\u8bf7\u6c42\uff0c\u518d\u6b21\u8fdb\u5165 ",(0,l.kt)("inlineCode",{parentName:"li"},"server")," \u6bb5\uff0c\u91cd\u8bd5 ",(0,l.kt)("inlineCode",{parentName:"li"},"location")," \u7684\u4e2d\u7684\u5339\u914d\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"break")," \u76f4\u63a5\u4f7f\u7528\u91cd\u5199\u540e\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \uff0c\u4e0d\u518d\u5339\u914d\u5176\u5b83 ",(0,l.kt)("inlineCode",{parentName:"li"},"location")," \u4e2d\u8bed\u53e5\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"redirect")," \u8fd4\u56de302\u4e34\u65f6\u91cd\u5b9a\u5411\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"permanent")," \u8fd4\u56de301\u6c38\u4e45\u91cd\u5b9a\u5411\uff1b")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"server{\n  listen 80;\n  server_name fe.lion.club; # \u8981\u5728\u672c\u5730hosts\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e\n  root html;\n  location /search {\n    rewrite ^/(.*) https://www.baidu.com redirect;\n  }\n  \n  location /images {\n    rewrite /images/(.*) /pics/$1;\n  }\n  \n  location /pics {\n    rewrite /pics/(.*) /photos/$1;\n  }\n  \n  location /photos {\n  \n  }\n}\n\n")),(0,l.kt)("p",null,"\u6309\u7167\u8fd9\u4e2a\u914d\u7f6e\u6211\u4eec\u6765\u5206\u6790\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5f53\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"li"},"fe.lion.club/search")," \u65f6\uff0c\u4f1a\u81ea\u52a8\u5e2e\u6211\u4eec\u91cd\u5b9a\u5411\u5230 ",(0,l.kt)("inlineCode",{parentName:"li"},"https://www.baidu.com"),"\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"li"},"fe.lion.club/images/1.jpg")," \u65f6\uff0c\u7b2c\u4e00\u6b65\u91cd\u5199 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"fe.lion.club/pics/1.jpg")," \uff0c\u627e\u5230 ",(0,l.kt)("inlineCode",{parentName:"li"},"pics")," \u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"location")," \uff0c\u7ee7\u7eed\u91cd\u5199 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \u4e3a ",(0,l.kt)("inlineCode",{parentName:"li"},"fe.lion.club/photos/1.jpg")," \uff0c\u627e\u5230 ",(0,l.kt)("inlineCode",{parentName:"li"},"/photos")," \u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"location")," \u540e\uff0c\u53bb ",(0,l.kt)("inlineCode",{parentName:"li"},"html/photos")," \u76ee\u5f55\u4e0b\u5bfb\u627e ",(0,l.kt)("inlineCode",{parentName:"li"},"1.jpg")," \u9759\u6001\u8d44\u6e90\u3002")),(0,l.kt)("h4",{id:"if-\u6307\u4ee4"},"if \u6307\u4ee4"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1aif (condition) {...}\n\n\u4e0a\u4e0b\u6587\uff1aserver\u3001location\n\n\u793a\u4f8b\uff1a\nif($http_user_agent ~ Chrome){\n  rewrite /(.*)/browser/$1 break;\n}\n\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"condition")," \u5224\u65ad\u6761\u4ef6\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"$variable")," \u4ec5\u4e3a\u53d8\u91cf\u65f6\uff0c\u503c\u4e3a\u7a7a\u6216\u4ee50\u5f00\u5934\u5b57\u7b26\u4e32\u90fd\u4f1a\u88ab\u5f53\u505a ",(0,l.kt)("inlineCode",{parentName:"li"},"false")," \u5904\u7406\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"=")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"li"},"!=")," \u76f8\u7b49\u6216\u4e0d\u7b49\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"~")," \u6b63\u5219\u5339\u914d\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"! ~")," \u975e\u6b63\u5219\u5339\u914d\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"~*")," \u6b63\u5219\u5339\u914d\uff0c\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"-f")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"li"},"! -f")," \u68c0\u6d4b\u6587\u4ef6\u5b58\u5728\u6216\u4e0d\u5b58\u5728\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"-d")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"li"},"! -d")," \u68c0\u6d4b\u76ee\u5f55\u5b58\u5728\u6216\u4e0d\u5b58\u5728\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"-e")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"li"},"! -e")," \u68c0\u6d4b\u6587\u4ef6\u3001\u76ee\u5f55\u3001\u7b26\u53f7\u94fe\u63a5\u7b49\u5b58\u5728\u6216\u4e0d\u5b58\u5728\uff1b"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"-x")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"li"},"! -x")," \u68c0\u6d4b\u6587\u4ef6\u53ef\u4ee5\u6267\u884c\u6216\u4e0d\u53ef\u6267\u884c\uff1b")),(0,l.kt)("p",null,"\u5b9e\u4f8b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'server {\n  listen 8080;\n  server_name localhost;\n  root html;\n  \n  location / {\n    if ( $uri = "/images/" ){\n        rewrite (.*) /pics/ break;\n    }\n  }\n}\n\n')),(0,l.kt)("p",null,"\u5f53\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"p"},"localhost:8080/images/")," \u65f6\uff0c\u4f1a\u8fdb\u5165 ",(0,l.kt)("inlineCode",{parentName:"p"},"if")," \u5224\u65ad\u91cc\u9762\u6267\u884c ",(0,l.kt)("inlineCode",{parentName:"p"},"rewrite")," \u547d\u4ee4\u3002"),(0,l.kt)("h4",{id:"autoindex"},"autoindex"),(0,l.kt)("p",null,"\u7528\u6237\u8bf7\u6c42\u4ee5 ",(0,l.kt)("inlineCode",{parentName:"p"},"/")," \u7ed3\u5c3e\u65f6\uff0c\u5217\u51fa\u76ee\u5f55\u7ed3\u6784\uff0c\u53ef\u4ee5\u7528\u4e8e\u5feb\u901f\u642d\u5efa\u9759\u6001\u8d44\u6e90\u4e0b\u8f7d\u7f51\u7ad9\u3002"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"autoindex.conf")," \u914d\u7f6e\u4fe1\u606f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"server {\n  listen 80;\n  server_name fe.lion-test.club;\n  \n  location /download/ {\n    root /opt/source;\n    \n    autoindex on; # \u6253\u5f00 autoindex\uff0c\uff0c\u53ef\u9009\u53c2\u6570\u6709 on | off\n    autoindex_exact_size on; # \u4fee\u6539\u4e3aoff\uff0c\u4ee5KB\u3001MB\u3001GB\u663e\u793a\u6587\u4ef6\u5927\u5c0f\uff0c\u9ed8\u8ba4\u4e3aon\uff0c\u4ee5bytes\u663e\u793a\u51fa\u2f42\u4ef6\u7684\u786e\u5207\u2f24\u2f29\n    autoindex_format html; # \u4ee5html\u7684\u65b9\u5f0f\u8fdb\u884c\u683c\u5f0f\u5316\uff0c\u53ef\u9009\u53c2\u6570\u6709 html | json | xml\n    autoindex_localtime off; # \u663e\u793a\u7684\u2f42\u4ef6\u65f6\u95f4\u4e3a\u2f42\u4ef6\u7684\u670d\u52a1\u5668\u65f6\u95f4\u3002\u9ed8\u8ba4\u4e3aoff\uff0c\u663e\u793a\u7684\u2f42\u4ef6\u65f6\u95f4\u4e3aGMT\u65f6\u95f4\n  }\n}\n\n")),(0,l.kt)("p",null,"\u5f53\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"p"},"fe.lion.com/download/")," \u65f6\uff0c\u4f1a\u628a\u670d\u52a1\u5668 ",(0,l.kt)("inlineCode",{parentName:"p"},"/opt/source/download/")," \u8def\u5f84\u4e0b\u7684\u6587\u4ef6\u5c55\u793a\u51fa\u6765\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/38aa834307654ae08ebf5aa72507daf7~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:"image.png"})),(0,l.kt)("h4",{id:"proxy_pass"},"proxy_pass"),(0,l.kt)("p",null,"\u7528\u4e8e\u914d\u7f6e\u4ee3\u7406\u670d\u52a1\u5668\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1aproxy_pass URL;\n\n\u4e0a\u4e0b\u6587\uff1alocation\u3001if\u3001limit_except\n\n\u793a\u4f8b\uff1a\nproxy_pass http://127.0.0.1:8081\nproxy_pass http://127.0.0.1:8081/proxy\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"URL")," \u53c2\u6570\u539f\u5219"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \u5fc5\u987b\u4ee5 ",(0,l.kt)("inlineCode",{parentName:"li"},"http")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"li"},"https")," \u5f00\u5934\uff1b"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \u4e2d\u53ef\u4ee5\u643a\u5e26\u53d8\u91cf\uff1b"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \u4e2d\u662f\u5426\u5e26 ",(0,l.kt)("inlineCode",{parentName:"li"},"URI")," \uff0c\u4f1a\u76f4\u63a5\u5f71\u54cd\u53d1\u5f80\u4e0a\u6e38\u8bf7\u6c42\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \uff1b")),(0,l.kt)("p",null,"\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u6765\u770b\u770b\u4e24\u79cd\u5e38\u89c1\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"URL")," \u7528\u6cd5\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"proxy_pass http://192.168.100.33:8081")," "),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"proxy_pass http://192.168.100.33:8081/"))),(0,l.kt)("p",null,"\u8fd9\u4e24\u79cd\u7528\u6cd5\u7684\u533a\u522b\u5c31\u662f\u5e26 ",(0,l.kt)("inlineCode",{parentName:"p"},"/")," \u548c\u4e0d\u5e26 ",(0,l.kt)("inlineCode",{parentName:"p"},"/")," \uff0c\u5728\u914d\u7f6e\u4ee3\u7406\u65f6\u5b83\u4eec\u7684\u533a\u522b\u53ef\u5927\u4e86\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u4e0d\u5e26 ",(0,l.kt)("inlineCode",{parentName:"li"},"/")," \u610f\u5473\u7740 ",(0,l.kt)("inlineCode",{parentName:"li"},"Nginx")," \u4e0d\u4f1a\u4fee\u6539\u7528\u6237 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \uff0c\u800c\u662f\u76f4\u63a5\u900f\u4f20\u7ed9\u4e0a\u6e38\u7684\u5e94\u7528\u670d\u52a1\u5668\uff1b"),(0,l.kt)("li",{parentName:"ul"},"\u5e26 ",(0,l.kt)("inlineCode",{parentName:"li"},"/")," \u610f\u5473\u7740 ",(0,l.kt)("inlineCode",{parentName:"li"},"Nginx")," \u4f1a\u4fee\u6539\u7528\u6237 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \uff0c\u4fee\u6539\u65b9\u6cd5\u662f\u5c06 ",(0,l.kt)("inlineCode",{parentName:"li"},"location")," \u540e\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \u4ece\u7528\u6237 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \u4e2d\u5220\u9664\uff1b")),(0,l.kt)("p",null,"\u4e0d\u5e26 ",(0,l.kt)("inlineCode",{parentName:"p"},"/")," \u7684\u7528\u6cd5\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"location /bbs/{\n  proxy_pass http://127.0.0.1:8080;\n}\n\n")),(0,l.kt)("p",null,"\u5206\u6790\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u7528\u6237\u8bf7\u6c42 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \uff1a ",(0,l.kt)("inlineCode",{parentName:"li"},"/bbs/abc/test.html")," "),(0,l.kt)("li",{parentName:"ol"},"\u8bf7\u6c42\u5230\u8fbe ",(0,l.kt)("inlineCode",{parentName:"li"},"Nginx")," \u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \uff1a ",(0,l.kt)("inlineCode",{parentName:"li"},"/bbs/abc/test.html")," "),(0,l.kt)("li",{parentName:"ol"},"\u8bf7\u6c42\u5230\u8fbe\u4e0a\u6e38\u5e94\u7528\u670d\u52a1\u5668\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \uff1a ",(0,l.kt)("inlineCode",{parentName:"li"},"/bbs/abc/test.html")," ")),(0,l.kt)("p",null,"\u5e26 ",(0,l.kt)("inlineCode",{parentName:"p"},"/")," \u7684\u7528\u6cd5\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"location /bbs/{\n  proxy_pass http://127.0.0.1:8080/;\n}\n\n")),(0,l.kt)("p",null,"\u5206\u6790\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u7528\u6237\u8bf7\u6c42 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \uff1a ",(0,l.kt)("inlineCode",{parentName:"li"},"/bbs/abc/test.html")," "),(0,l.kt)("li",{parentName:"ol"},"\u8bf7\u6c42\u5230\u8fbe ",(0,l.kt)("inlineCode",{parentName:"li"},"Nginx")," \u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \uff1a ",(0,l.kt)("inlineCode",{parentName:"li"},"/bbs/abc/test.html")," "),(0,l.kt)("li",{parentName:"ol"},"\u8bf7\u6c42\u5230\u8fbe\u4e0a\u6e38\u5e94\u7528\u670d\u52a1\u5668\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"URL")," \uff1a ",(0,l.kt)("inlineCode",{parentName:"li"},"/abc/test.html")," ")),(0,l.kt)("p",null,"\u5e76\u6ca1\u6709\u62fc\u63a5\u4e0a ",(0,l.kt)("inlineCode",{parentName:"p"},"/bbs")," \uff0c\u8fd9\u70b9\u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"root")," \u4e0e ",(0,l.kt)("inlineCode",{parentName:"p"},"alias")," \u4e4b\u95f4\u7684\u533a\u522b\u662f\u4fdd\u6301\u4e00\u81f4\u7684\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4f8b\u5982\uff1a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"\u5047\u8bbe\u4e0b\u9762\u56db\u79cd\u60c5\u51b5\u5206\u522b\u7528 http://192.168.1.188/proxy/test.html \u8fdb\u884c\u8bbf\u95ee\u3002\n\u7b2c\u4e00\u79cd\uff1a\nlocation /proxy/ {\n    proxy_pass http://127.0.0.1/;\n}\n\u4ee3\u7406\u5230URL\uff1ahttp://127.0.0.1/test.html\n\n\u7b2c\u4e8c\u79cd\uff08\u76f8\u5bf9\u4e8e\u7b2c\u4e00\u79cd\uff0c\u6700\u540e\u5c11\u4e00\u4e2a / \uff09\nlocation /proxy/ {\n    proxy_pass http://127.0.0.1;\n}\n\u4ee3\u7406\u5230URL\uff1ahttp://127.0.0.1/proxy/test.html\n\n\u7b2c\u4e09\u79cd\uff1a\nlocation /proxy/ {\n    proxy_pass http://127.0.0.1/aaa/;\n}\n\u4ee3\u7406\u5230URL\uff1ahttp://127.0.0.1/aaa/test.html\n\n\u7b2c\u56db\u79cd\uff08\u76f8\u5bf9\u4e8e\u7b2c\u4e09\u79cd\uff0c\u6700\u540e\u5c11\u4e00\u4e2a / \uff09\nlocation /proxy/ {\n    proxy_pass http://127.0.0.1/aaa;\n}\n\n\u4ee3\u7406\u5230URL\uff1ahttp://127.0.0.1/aaatest.html\n")),(0,l.kt)("h2",{id:"4-\u53d8\u91cf"},"4. \u53d8\u91cf"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u63d0\u4f9b\u7ed9\u4f7f\u7528\u8005\u7684\u53d8\u91cf\u975e\u5e38\u591a\uff0c\u4f46\u662f\u7ec8\u7a76\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u8bf7\u6c42\u8fc7\u7a0b\u6240\u4ea7\u751f\u6570\u636e\uff0c ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u5c06\u8fd9\u4e9b\u6570\u636e\u4ee5\u53d8\u91cf\u7684\u5f62\u5f0f\u63d0\u4f9b\u7ed9\u4f7f\u7528\u8005\u3002"),(0,l.kt)("p",null,"\u4e0b\u9762\u5217\u4e3e\u4e9b\u9879\u76ee\u4e2d\u5e38\u7528\u7684\u53d8\u91cf\uff1a"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u53d8\u91cf\u540d"),(0,l.kt)("th",{parentName:"tr",align:null},"\u542b\u4e49"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"remote_addr")),(0,l.kt)("td",{parentName:"tr",align:null},"\u5ba2\u6237\u7aef ",(0,l.kt)("inlineCode",{parentName:"td"},"IP")," \u5730\u5740")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"remote_port")),(0,l.kt)("td",{parentName:"tr",align:null},"\u5ba2\u6237\u7aef\u7aef\u53e3")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"server_addr")),(0,l.kt)("td",{parentName:"tr",align:null},"\u670d\u52a1\u7aef ",(0,l.kt)("inlineCode",{parentName:"td"},"IP")," \u5730\u5740")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"server_port")),(0,l.kt)("td",{parentName:"tr",align:null},"\u670d\u52a1\u7aef\u7aef\u53e3")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"server_protocol")),(0,l.kt)("td",{parentName:"tr",align:null},"\u670d\u52a1\u7aef\u534f\u8bae")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"binary_remote_addr")),(0,l.kt)("td",{parentName:"tr",align:null},"\u4e8c\u8fdb\u5236\u683c\u5f0f\u7684\u5ba2\u6237\u7aef ",(0,l.kt)("inlineCode",{parentName:"td"},"IP")," \u5730\u5740")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"connection")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"TCP")," \u8fde\u63a5\u7684\u5e8f\u53f7\uff0c\u9012\u589e")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"connection_request")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"TCP")," \u8fde\u63a5\u5f53\u524d\u7684\u8bf7\u6c42\u6570\u91cf")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"uri")),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bf7\u6c42\u7684URL\uff0c\u4e0d\u5305\u542b\u53c2\u6570")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"request_uri")),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bf7\u6c42\u7684URL\uff0c\u5305\u542b\u53c2\u6570")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"scheme")),(0,l.kt)("td",{parentName:"tr",align:null},"\u534f\u8bae\u540d\uff0c ",(0,l.kt)("inlineCode",{parentName:"td"},"http")," \u6216 ",(0,l.kt)("inlineCode",{parentName:"td"},"https"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"request_method")),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bf7\u6c42\u65b9\u6cd5")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"request_length")),(0,l.kt)("td",{parentName:"tr",align:null},"\u5168\u90e8\u8bf7\u6c42\u7684\u957f\u5ea6\uff0c\u5305\u542b\u8bf7\u6c42\u884c\u3001\u8bf7\u6c42\u5934\u3001\u8bf7\u6c42\u4f53")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"args")),(0,l.kt)("td",{parentName:"tr",align:null},"\u5168\u90e8\u53c2\u6570\u5b57\u7b26\u4e32")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"arg_\u53c2\u6570\u540d")),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u7279\u5b9a\u53c2\u6570\u503c")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"is_args")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"URL")," \u4e2d\u662f\u5426\u6709\u53c2\u6570\uff0c\u6709\u7684\u8bdd\u8fd4\u56de ",(0,l.kt)("inlineCode",{parentName:"td"},"?")," \uff0c\u5426\u5219\u8fd4\u56de\u7a7a")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"query_string")),(0,l.kt)("td",{parentName:"tr",align:null},"\u4e0e ",(0,l.kt)("inlineCode",{parentName:"td"},"args")," \u76f8\u540c")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"host")),(0,l.kt)("td",{parentName:"tr",align:null},"\u8bf7\u6c42\u4fe1\u606f\u4e2d\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"Host")," \uff0c\u5982\u679c\u8bf7\u6c42\u4e2d\u6ca1\u6709 ",(0,l.kt)("inlineCode",{parentName:"td"},"Host")," \u884c\uff0c\u5219\u5728\u8bf7\u6c42\u5934\u4e2d\u627e\uff0c\u6700\u540e\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"td"},"nginx")," \u4e2d\u8bbe\u7f6e\u7684 ",(0,l.kt)("inlineCode",{parentName:"td"},"server_name")," \u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"http_user_agent")),(0,l.kt)("td",{parentName:"tr",align:null},"\u7528\u6237\u6d4f\u89c8\u5668")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"http_referer")),(0,l.kt)("td",{parentName:"tr",align:null},"\u4ece\u54ea\u4e9b\u94fe\u63a5\u8fc7\u6765\u7684\u8bf7\u6c42")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"http_via")),(0,l.kt)("td",{parentName:"tr",align:null},"\u6bcf\u7ecf\u8fc7\u4e00\u5c42\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u90fd\u4f1a\u6dfb\u52a0\u76f8\u5e94\u7684\u4fe1\u606f")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"http_cookie")),(0,l.kt)("td",{parentName:"tr",align:null},"\u83b7\u53d6\u7528\u6237 ",(0,l.kt)("inlineCode",{parentName:"td"},"cookie"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"request_time")),(0,l.kt)("td",{parentName:"tr",align:null},"\u5904\u7406\u8bf7\u6c42\u5df2\u6d88\u8017\u7684\u65f6\u95f4")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"https")),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f\u5426\u5f00\u542f\u4e86 ",(0,l.kt)("inlineCode",{parentName:"td"},"https")," \uff0c\u662f\u5219\u8fd4\u56de ",(0,l.kt)("inlineCode",{parentName:"td"},"on")," \uff0c\u5426\u5219\u8fd4\u56de\u7a7a")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"request_filename")),(0,l.kt)("td",{parentName:"tr",align:null},"\u78c1\u76d8\u6587\u4ef6\u7cfb\u7edf\u5f85\u8bbf\u95ee\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"document_root")),(0,l.kt)("td",{parentName:"tr",align:null},"\u7531 ",(0,l.kt)("inlineCode",{parentName:"td"},"URI")," \u548c ",(0,l.kt)("inlineCode",{parentName:"td"},"root/alias")," \u89c4\u5219\u751f\u6210\u7684\u6587\u4ef6\u5939\u8def\u5f84")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"limit_rate")),(0,l.kt)("td",{parentName:"tr",align:null},"\u8fd4\u56de\u54cd\u5e94\u65f6\u7684\u901f\u5ea6\u4e0a\u9650\u503c")))),(0,l.kt)("h2",{id:"5-nginx-\u5e94\u7528\u6838\u5fc3\u6982\u5ff5"},"5. Nginx \u5e94\u7528\u6838\u5fc3\u6982\u5ff5"),(0,l.kt)("p",null,"\u4ee3\u7406\u662f\u5728\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u4e4b\u95f4\u5047\u8bbe\u7684\u4e00\u5c42\u670d\u52a1\u5668\uff0c\u4ee3\u7406\u5c06\u63a5\u6536\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u5e76\u5c06\u5b83\u8f6c\u53d1\u7ed9\u670d\u52a1\u5668\uff0c\u7136\u540e\u5c06\u670d\u52a1\u7aef\u7684\u54cd\u5e94\u8f6c\u53d1\u7ed9\u5ba2\u6237\u7aef\u3002"),(0,l.kt)("p",null,"\u4e0d\u7ba1\u662f\u6b63\u5411\u4ee3\u7406\u8fd8\u662f\u53cd\u5411\u4ee3\u7406\uff0c\u5b9e\u73b0\u7684\u90fd\u662f\u4e0a\u9762\u7684\u529f\u80fd\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8232e3b1d3854ee2bdc743ad1f656414~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:"image.png"})),(0,l.kt)("h3",{id:"51-\u6b63\u5411\u4ee3\u7406"},"5.1 \u6b63\u5411\u4ee3\u7406"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u6b63\u5411\u4ee3\u7406\uff0c\u610f\u601d\u662f\u4e00\u4e2a\u4f4d\u4e8e\u5ba2\u6237\u7aef\u548c\u539f\u59cb\u670d\u52a1\u5668(origin server)\u4e4b\u95f4\u7684\u670d\u52a1\u5668\uff0c\u4e3a\u4e86\u4ece\u539f\u59cb\u670d\u52a1\u5668\u53d6\u5f97\u5185\u5bb9\uff0c\u5ba2\u6237\u7aef\u5411\u4ee3\u7406\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u5e76\u6307\u5b9a\u76ee\u6807(\u539f\u59cb\u670d\u52a1\u5668)\uff0c\u7136\u540e\u4ee3\u7406\u5411\u539f\u59cb\u670d\u52a1\u5668\u8f6c\u4ea4\u8bf7\u6c42\u5e76\u5c06\u83b7\u5f97\u7684\u5185\u5bb9\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002")),(0,l.kt)("p",null,"\u6b63\u5411\u4ee3\u7406\u662f\u4e3a\u6211\u4eec\u670d\u52a1\u7684\uff0c\u5373\u4e3a\u5ba2\u6237\u7aef\u670d\u52a1\u7684\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u6839\u636e\u6b63\u5411\u4ee3\u7406\u8bbf\u95ee\u5230\u5b83\u672c\u8eab\u65e0\u6cd5\u8bbf\u95ee\u5230\u7684\u670d\u52a1\u5668\u8d44\u6e90\u3002"),(0,l.kt)("p",null,"\u6b63\u5411\u4ee3\u7406\u5bf9\u6211\u4eec\u662f\u900f\u660e\u7684\uff0c\u5bf9\u670d\u52a1\u7aef\u662f\u975e\u900f\u660e\u7684\uff0c\u5373\u670d\u52a1\u7aef\u5e76\u4e0d\u77e5\u9053\u81ea\u5df1\u6536\u5230\u7684\u662f\u6765\u81ea\u4ee3\u7406\u7684\u8bbf\u95ee\u8fd8\u662f\u6765\u81ea\u771f\u5b9e\u5ba2\u6237\u7aef\u7684\u8bbf\u95ee\u3002"),(0,l.kt)("h3",{id:"52-\u53cd\u5411\u4ee3\u7406"},"5.2 \u53cd\u5411\u4ee3\u7406"),(0,l.kt)("blockquote",null,(0,l.kt)("ul",{parentName:"blockquote"},(0,l.kt)("li",{parentName:"ul"},"\u53cd\u5411\u4ee3\u7406*\uff08Reverse Proxy\uff09\u65b9\u5f0f\u662f\u6307\u4ee5\u4ee3\u7406\u670d\u52a1\u5668\u6765\u63a5\u53d7internet\u4e0a\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u7136\u540e\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u5185\u90e8\u7f51\u7edc\u4e0a\u7684\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u4ece\u670d\u52a1\u5668\u4e0a\u5f97\u5230\u7684\u7ed3\u679c\u8fd4\u56de\u7ed9internet\u4e0a\u8bf7\u6c42\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\uff0c\u6b64\u65f6\u4ee3\u7406\u670d\u52a1\u5668\u5bf9\u5916\u5c31\u8868\u73b0\u4e3a\u4e00\u4e2a\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\u3002"))),(0,l.kt)("p",null,"\u53cd\u5411\u4ee3\u7406\u662f\u4e3a\u670d\u52a1\u7aef\u670d\u52a1\u7684\uff0c\u53cd\u5411\u4ee3\u7406\u53ef\u4ee5\u5e2e\u52a9\u670d\u52a1\u5668\u63a5\u6536\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u5e2e\u52a9\u670d\u52a1\u5668\u505a\u8bf7\u6c42\u8f6c\u53d1\uff0c\u8d1f\u8f7d\u5747\u8861\u7b49\u3002"),(0,l.kt)("p",null,"\u53cd\u5411\u4ee3\u7406\u5bf9\u670d\u52a1\u7aef\u662f\u900f\u660e\u7684\uff0c\u5bf9\u6211\u4eec\u662f\u975e\u900f\u660e\u7684\uff0c\u5373\u6211\u4eec\u5e76\u4e0d\u77e5\u9053\u81ea\u5df1\u8bbf\u95ee\u7684\u662f\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u800c\u670d\u52a1\u5668\u77e5\u9053\u53cd\u5411\u4ee3\u7406\u5728\u4e3a\u4ed6\u670d\u52a1\u3002"),(0,l.kt)("p",null,"\u53cd\u5411\u4ee3\u7406\u7684\u4f18\u52bf\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u9690\u85cf\u771f\u5b9e\u670d\u52a1\u5668\uff1b"),(0,l.kt)("li",{parentName:"ul"},"\u8d1f\u8f7d\u5747\u8861\u4fbf\u4e8e\u6a2a\u5411\u6269\u5145\u540e\u7aef\u52a8\u6001\u670d\u52a1\uff1b"),(0,l.kt)("li",{parentName:"ul"},"\u52a8\u9759\u5206\u79bb\uff0c\u63d0\u5347\u7cfb\u7edf\u5065\u58ee\u6027\uff1b")),(0,l.kt)("p",null,"\u90a3\u4e48\u201c\u52a8\u9759\u5206\u79bb\u201d\u662f\u4ec0\u4e48\uff1f\u8d1f\u8f7d\u5747\u8861\u53c8\u662f\u4ec0\u4e48\uff1f"),(0,l.kt)("h3",{id:"53-\u52a8\u9759\u5206\u79bb"},"5.3 \u52a8\u9759\u5206\u79bb"),(0,l.kt)("p",null,"\u52a8\u9759\u5206\u79bb\u662f\u6307\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"web")," \u670d\u52a1\u5668\u67b6\u6784\u4e2d\uff0c\u5c06\u9759\u6001\u9875\u9762\u4e0e\u52a8\u6001\u9875\u9762\u6216\u8005\u9759\u6001\u5185\u5bb9\u63a5\u53e3\u548c\u52a8\u6001\u5185\u5bb9\u63a5\u53e3\u5206\u5f00\u4e0d\u540c\u7cfb\u7edf\u8bbf\u95ee\u7684\u67b6\u6784\u8bbe\u8ba1\u65b9\u6cd5\uff0c\u8fdb\u800c\u63d0\u793a\u6574\u4e2a\u670d\u52a1\u7684\u8bbf\u95ee\u6027\u548c\u53ef\u7ef4\u62a4\u6027\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/96c9221f098542ba8222565298c4038e~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:"\u672a\u547d\u540d\u6587\u4ef6.png"})),(0,l.kt)("p",null,"\u4e00\u822c\u6765\u8bf4\uff0c\u90fd\u9700\u8981\u5c06\u52a8\u6001\u8d44\u6e90\u548c\u9759\u6001\u8d44\u6e90\u5206\u5f00\uff0c\u7531\u4e8e ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u7684\u9ad8\u5e76\u53d1\u548c\u9759\u6001\u8d44\u6e90\u7f13\u5b58\u7b49\u7279\u6027\uff0c\u7ecf\u5e38\u5c06\u9759\u6001\u8d44\u6e90\u90e8\u7f72\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u4e0a\u3002\u5982\u679c\u8bf7\u6c42\u7684\u662f\u9759\u6001\u8d44\u6e90\uff0c\u76f4\u63a5\u5230\u9759\u6001\u8d44\u6e90\u76ee\u5f55\u83b7\u53d6\u8d44\u6e90\uff0c\u5982\u679c\u662f\u52a8\u6001\u8d44\u6e90\u7684\u8bf7\u6c42\uff0c\u5219\u5229\u7528\u53cd\u5411\u4ee3\u7406\u7684\u539f\u7406\uff0c\u628a\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u5bf9\u5e94\u540e\u53f0\u5e94\u7528\u53bb\u5904\u7406\uff0c\u4ece\u800c\u5b9e\u73b0\u52a8\u9759\u5206\u79bb\u3002"),(0,l.kt)("p",null,"\u4f7f\u7528\u524d\u540e\u7aef\u5206\u79bb\u540e\uff0c\u53ef\u4ee5\u5f88\u5927\u7a0b\u5ea6\u63d0\u5347\u9759\u6001\u8d44\u6e90\u7684\u8bbf\u95ee\u901f\u5ea6\uff0c\u5373\u4f7f\u52a8\u6001\u670d\u52a1\u4e0d\u53ef\u7528\uff0c\u9759\u6001\u8d44\u6e90\u7684\u8bbf\u95ee\u4e5f\u4e0d\u4f1a\u53d7\u5230\u5f71\u54cd\u3002"),(0,l.kt)("h3",{id:"54-\u8d1f\u8f7d\u5747\u8861"},"5.4 \u8d1f\u8f7d\u5747\u8861"),(0,l.kt)("p",null,"\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u5ba2\u6237\u7aef\u53d1\u9001\u591a\u4e2a\u8bf7\u6c42\u5230\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u5904\u7406\u8bf7\u6c42\uff0c\u5176\u4e2d\u4e00\u90e8\u5206\u53ef\u80fd\u8981\u64cd\u4f5c\u4e00\u4e9b\u8d44\u6e90\u6bd4\u5982\u6570\u636e\u5e93\u3001\u9759\u6001\u8d44\u6e90\u7b49\uff0c\u670d\u52a1\u5668\u5904\u7406\u5b8c\u6bd5\u540e\uff0c\u518d\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002"),(0,l.kt)("p",null,"\u8fd9\u79cd\u6a21\u5f0f\u5bf9\u4e8e\u65e9\u671f\u7684\u7cfb\u7edf\u6765\u8bf4\uff0c\u529f\u80fd\u8981\u6c42\u4e0d\u590d\u6742\uff0c\u4e14\u5e76\u53d1\u8bf7\u6c42\u76f8\u5bf9\u8f83\u5c11\u7684\u60c5\u51b5\u4e0b\u8fd8\u80fd\u80dc\u4efb\uff0c\u6210\u672c\u4e5f\u4f4e\u3002\u968f\u7740\u4fe1\u606f\u6570\u91cf\u4e0d\u65ad\u589e\u957f\uff0c\u8bbf\u95ee\u91cf\u548c\u6570\u636e\u91cf\u98de\u901f\u589e\u957f\uff0c\u4ee5\u53ca\u7cfb\u7edf\u4e1a\u52a1\u590d\u6742\u5ea6\u6301\u7eed\u589e\u52a0\uff0c\u8fd9\u79cd\u505a\u6cd5\u5df2\u65e0\u6cd5\u6ee1\u8db3\u8981\u6c42\uff0c\u5e76\u53d1\u91cf\u7279\u522b\u5927\u65f6\uff0c\u670d\u52a1\u5668\u5bb9\u6613\u5d29\u3002"),(0,l.kt)("p",null,"\u5f88\u660e\u663e\u8fd9\u662f\u7531\u4e8e\u670d\u52a1\u5668\u6027\u80fd\u7684\u74f6\u9888\u9020\u6210\u7684\u95ee\u9898\uff0c\u9664\u4e86\u5806\u673a\u5668\u4e4b\u5916\uff0c\u6700\u91cd\u8981\u7684\u505a\u6cd5\u5c31\u662f\u8d1f\u8f7d\u5747\u8861\u3002"),(0,l.kt)("p",null,"\u8bf7\u6c42\u7206\u53d1\u5f0f\u589e\u957f\u7684\u60c5\u51b5\u4e0b\uff0c\u5355\u4e2a\u673a\u5668\u6027\u80fd\u518d\u5f3a\u52b2\u4e5f\u65e0\u6cd5\u6ee1\u8db3\u8981\u6c42\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u96c6\u7fa4\u7684\u6982\u5ff5\u4ea7\u751f\u4e86\uff0c\u5355\u4e2a\u670d\u52a1\u5668\u89e3\u51b3\u4e0d\u4e86\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a\u670d\u52a1\u5668\uff0c\u7136\u540e\u5c06\u8bf7\u6c42\u5206\u53d1\u5230\u5404\u4e2a\u670d\u52a1\u5668\u4e0a\uff0c\u5c06\u8d1f\u8f7d\u5206\u53d1\u5230\u4e0d\u540c\u7684\u670d\u52a1\u5668\uff0c\u8fd9\u5c31\u662f\u8d1f\u8f7d\u5747\u8861\uff0c\u6838\u5fc3\u662f\u300c\u5206\u644a\u538b\u529b\u300d\u3002 ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\uff0c\u4e00\u822c\u6765\u8bf4\u6307\u7684\u662f\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u670d\u52a1\u5668\u96c6\u7fa4\u3002"),(0,l.kt)("p",null,"\u4e3e\u4e2a\u5177\u4f53\u7684\u4f8b\u5b50\uff0c\u665a\u9ad8\u5cf0\u4e58\u5750\u5730\u94c1\u7684\u65f6\u5019\uff0c\u5165\u7ad9\u53e3\u7ecf\u5e38\u4f1a\u6709\u5730\u94c1\u5de5\u4f5c\u4eba\u5458\u5927\u5587\u53ed\u201c\u8bf7\u8d70 ",(0,l.kt)("inlineCode",{parentName:"p"},"B")," \u53e3\uff0c ",(0,l.kt)("inlineCode",{parentName:"p"},"B")," \u53e3\u4eba\u5c11\u8f66\u7a7a....\u201d\uff0c\u8fd9\u4e2a\u5de5\u4f5c\u4eba\u5458\u7684\u4f5c\u7528\u5c31\u662f\u8d1f\u8f7d\u5747\u8861\u3002\n",(0,l.kt)("img",{parentName:"p",src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5f79f698d1fc497db14c971ea417f456~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:"\u672a\u547d\u540d\u6587\u4ef6 (3).png"})),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u7684\u7b56\u7565\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u8f6e\u8be2\u7b56\u7565\uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u91c7\u7528\u7684\u7b56\u7565\uff0c\u5c06\u6240\u6709\u5ba2\u6237\u7aef\u8bf7\u6c42\u8f6e\u8be2\u5206\u914d\u7ed9\u670d\u52a1\u7aef\u3002\u8fd9\u79cd\u7b56\u7565\u662f\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u7684\uff0c\u4f46\u662f\u5982\u679c\u5176\u4e2d\u67d0\u4e00\u53f0\u670d\u52a1\u5668\u538b\u529b\u592a\u5927\uff0c\u51fa\u73b0\u5ef6\u8fdf\uff0c\u4f1a\u5f71\u54cd\u6240\u6709\u5206\u914d\u5728\u8fd9\u53f0\u670d\u52a1\u5668\u4e0b\u7684\u7528\u6237\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u6700\u5c0f\u8fde\u63a5\u6570\u7b56\u7565\uff1a\u5c06\u8bf7\u6c42\u4f18\u5148\u5206\u914d\u7ed9\u538b\u529b\u8f83\u5c0f\u7684\u670d\u52a1\u5668\uff0c\u5b83\u53ef\u4ee5\u5e73\u8861\u6bcf\u4e2a\u961f\u5217\u7684\u957f\u5ea6\uff0c\u5e76\u907f\u514d\u5411\u538b\u529b\u5927\u7684\u670d\u52a1\u5668\u6dfb\u52a0\u66f4\u591a\u7684\u8bf7\u6c42\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u6700\u5feb\u54cd\u5e94\u65f6\u95f4\u7b56\u7565\uff1a\u4f18\u5148\u5206\u914d\u7ed9\u54cd\u5e94\u65f6\u95f4\u6700\u77ed\u7684\u670d\u52a1\u5668\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aef ",(0,l.kt)("inlineCode",{parentName:"li"},"ip")," \u7ed1\u5b9a\u7b56\u7565\uff1a\u6765\u81ea\u540c\u4e00\u4e2a ",(0,l.kt)("inlineCode",{parentName:"li"},"ip")," \u7684\u8bf7\u6c42\u6c38\u8fdc\u53ea\u5206\u914d\u4e00\u53f0\u670d\u52a1\u5668\uff0c\u6709\u6548\u89e3\u51b3\u4e86\u52a8\u6001\u7f51\u9875\u5b58\u5728\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"session")," \u5171\u4eab\u95ee\u9898\u3002")),(0,l.kt)("h2",{id:"6-\u914d\u7f6e\u7f13\u5b58"},"6. \u914d\u7f6e\u7f13\u5b58"),(0,l.kt)("p",null,"\u7f13\u5b58\u53ef\u4ee5\u975e\u5e38\u6709\u6548\u7684\u63d0\u5347\u6027\u80fd\uff0c\u56e0\u6b64\u4e0d\u8bba\u662f\u5ba2\u6237\u7aef\uff08\u6d4f\u89c8\u5668\uff09\uff0c\u8fd8\u662f\u4ee3\u7406\u670d\u52a1\u5668\uff08 ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \uff09\uff0c\u4e43\u81f3\u4e0a\u6e38\u670d\u52a1\u5668\u90fd\u591a\u5c11\u4f1a\u6d89\u53ca\u5230\u7f13\u5b58\u3002\u53ef\u89c1\u7f13\u5b58\u5728\u6bcf\u4e2a\u73af\u8282\u90fd\u662f\u975e\u5e38\u91cd\u8981\u7684\u3002\u4e0b\u9762\u8ba9\u6211\u4eec\u6765\u5b66\u4e60 ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u4e2d\u5982\u4f55\u8bbe\u7f6e\u7f13\u5b58\u7b56\u7565\u3002"),(0,l.kt)("h3",{id:"proxy_cache"},"proxy_cache"),(0,l.kt)("p",null,"\u5b58\u50a8\u4e00\u4e9b\u4e4b\u524d\u88ab\u8bbf\u95ee\u8fc7\u3001\u800c\u4e14\u53ef\u80fd\u5c06\u8981\u88ab\u518d\u6b21\u8bbf\u95ee\u7684\u8d44\u6e90\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u4ece\u4ee3\u7406\u670d\u52a1\u5668\u83b7\u5f97\uff0c\u4ece\u800c\u51cf\u5c11\u4e0a\u6e38\u670d\u52a1\u5668\u7684\u538b\u529b\uff0c\u52a0\u5feb\u6574\u4e2a\u8bbf\u95ee\u901f\u5ea6\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1aproxy_cache zone | off ; # zone \u662f\u5171\u4eab\u5185\u5b58\u7684\u540d\u79f0\n\n\u9ed8\u8ba4\u503c\uff1aproxy_cache off;\n\n\u4e0a\u4e0b\u6587\uff1ahttp\u3001server\u3001location\n\n")),(0,l.kt)("h3",{id:"proxy_cache_path"},"proxy_cache_path"),(0,l.kt)("p",null,"\u8bbe\u7f6e\u7f13\u5b58\u6587\u4ef6\u7684\u5b58\u653e\u8def\u5f84\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1aproxy_cache_path path [levels=levels] [use_temp_path=on|off] keys_zone=name:size [inactive=time] [max_size=size] [manager_files=number] [manager_sleep=time] [manager_threshold=time] [loader_files=number] [loader_sleep=time] [loader_threshold=time] [purger=on|off] [purger_files=number] [purger_sleep=time] [purger_threshold=time];\n\n\u9ed8\u8ba4\u503c\uff1aproxy_cache_path off\n\n\u4e0a\u4e0b\u6587\uff1ahttp\n\n")),(0,l.kt)("p",null,"\u53c2\u6570\u542b\u4e49\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"path"),"\uff1a\u7f13\u5b58\u7684\u8def\u5f84\u5730\u5740\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"levels"),"\uff1a\u7f13\u5b58\u5b58\u50a8\u7684\u5c42\u6b21\u7ed3\u6784\uff0c\u6700\u591a\u5141\u8bb8\u4e09\u5c42\u76ee\u5f55\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"use_temp_path"),"\uff1a\u662f\u5426\u4f7f\u7528\u4e34\u65f6\u76ee\u5f55\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"keys_zone"),"\uff1a\u6307\u5b9a\u4e00\u4e2a\u5171\u4eab\u5185\u5b58\u7a7a\u95f4\u6765\u5b58\u50a8\u70ed\u70b9",(0,l.kt)("inlineCode",{parentName:"li"},"Key"),"(",(0,l.kt)("inlineCode",{parentName:"li"},"1M"),"\u53ef\u5b58\u50a8",(0,l.kt)("inlineCode",{parentName:"li"},"8000"),"\u4e2a",(0,l.kt)("inlineCode",{parentName:"li"},"Key"),")\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"inactive"),"\uff1a\u8bbe\u7f6e\u7f13\u5b58\u591a\u957f\u65f6\u95f4\u672a\u88ab\u8bbf\u95ee\u540e\u5220\u9664\uff08\u9ed8\u8ba4\u662f\u5341\u5206\u949f\uff09\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"max_size"),"\uff1a\u5141\u8bb8\u7f13\u5b58\u7684\u6700\u5927\u5b58\u50a8\u7a7a\u95f4\uff0c\u8d85\u51fa\u540e\u4f1a\u57fa\u4e8e",(0,l.kt)("inlineCode",{parentName:"li"},"LRU"),"\u7b97\u6cd5\u79fb\u9664\u7f13\u5b58\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"Nginx"),"\u4f1a\u521b\u5efa\u4e00\u4e2a",(0,l.kt)("inlineCode",{parentName:"li"},"Cache manager"),"\u7684\u8fdb\u7a0b\u79fb\u9664\u6570\u636e\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7",(0,l.kt)("inlineCode",{parentName:"li"},"purge"),"\u65b9\u5f0f\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"manager_files"),"\uff1a",(0,l.kt)("inlineCode",{parentName:"li"},"manager"),"\u8fdb\u7a0b\u6bcf\u6b21\u79fb\u9664\u7f13\u5b58\u6587\u4ef6\u6570\u91cf\u7684\u4e0a\u9650\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"manager_sleep"),"\uff1a",(0,l.kt)("inlineCode",{parentName:"li"},"manager"),"\u8fdb\u7a0b\u6bcf\u6b21\u79fb\u9664\u7f13\u5b58\u6587\u4ef6\u7684\u65f6\u95f4\u4e0a\u9650\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"manager_threshold"),"\uff1a",(0,l.kt)("inlineCode",{parentName:"li"},"manager"),"\u8fdb\u7a0b\u6bcf\u6b21\u79fb\u9664\u7f13\u5b58\u540e\u7684\u95f4\u9694\u65f6\u95f4\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"loader_files"),"\uff1a\u91cd\u542f",(0,l.kt)("inlineCode",{parentName:"li"},"Nginx"),"\u8f7d\u5165\u7f13\u5b58\u65f6\uff0c\u6bcf\u6b21\u52a0\u8f7d\u7684\u4e2a\u6570\uff0c\u9ed8\u8ba4",(0,l.kt)("inlineCode",{parentName:"li"},"100"),"\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"loader_sleep"),"\uff1a\u6bcf\u6b21\u8f7d\u5165\u65f6\uff0c\u5141\u8bb8\u7684\u6700\u5927\u65f6\u95f4\u4e0a\u9650\uff0c\u9ed8\u8ba4",(0,l.kt)("inlineCode",{parentName:"li"},"200ms"),"\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"loader_threshold"),"\uff1a\u4e00\u6b21\u8f7d\u5165\u540e\uff0c\u505c\u987f\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u9ed8\u8ba4",(0,l.kt)("inlineCode",{parentName:"li"},"50ms"),"\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"purger"),"\uff1a\u662f\u5426\u5f00\u542f",(0,l.kt)("inlineCode",{parentName:"li"},"purge"),"\u65b9\u5f0f\u79fb\u9664\u6570\u636e\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"purger_files"),"\uff1a\u6bcf\u6b21\u79fb\u9664\u7f13\u5b58\u6587\u4ef6\u65f6\u7684\u6570\u91cf\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"purger_sleep"),"\uff1a\u6bcf\u6b21\u79fb\u9664\u65f6\uff0c\u5141\u8bb8\u6d88\u8017\u7684\u6700\u5927\u65f6\u95f4\u3002"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"purger_threshold"),"\uff1a\u6bcf\u6b21\u79fb\u9664\u5b8c\u6210\u540e\uff0c\u505c\u987f\u7684\u95f4\u9694\u65f6\u95f4\u3002")),(0,l.kt)("h3",{id:"proxy_cache_key"},"proxy_cache_key"),(0,l.kt)("p",null,"\u8bbe\u7f6e\u7f13\u5b58\u6587\u4ef6\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"key")," \u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1aproxy_cache_key\n\n\u9ed8\u8ba4\u503c\uff1aproxy_cache_key $scheme$proxy_host$request_uri;\n\n\u4e0a\u4e0b\u6587\uff1ahttp\u3001server\u3001location\n\n")),(0,l.kt)("h3",{id:"proxy_cache_valid"},"proxy_cache_valid"),(0,l.kt)("p",null,"\u914d\u7f6e\u4ec0\u4e48\u72b6\u6001\u7801\u53ef\u4ee5\u88ab\u7f13\u5b58\uff0c\u4ee5\u53ca\u7f13\u5b58\u65f6\u957f\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1aproxy_cache_valid [code...] time;\n\n\u4e0a\u4e0b\u6587\uff1ahttp\u3001server\u3001location\n\n\u914d\u7f6e\u793a\u4f8b\uff1aproxy_cache_valid 200 304 2m;; # \u8bf4\u660e\u5bf9\u4e8e\u72b6\u6001\u4e3a200\u548c304\u7684\u7f13\u5b58\u6587\u4ef6\u7684\u7f13\u5b58\u65f6\u95f4\u662f2\u5206\u949f\n\n")),(0,l.kt)("h3",{id:"proxy_no_cache"},"proxy_no_cache"),(0,l.kt)("p",null,"\u5b9a\u4e49\u76f8\u5e94\u4fdd\u5b58\u5230\u7f13\u5b58\u7684\u6761\u4ef6\uff0c\u5982\u679c\u5b57\u7b26\u4e32\u53c2\u6570\u7684\u81f3\u5c11\u4e00\u4e2a\u503c\u4e0d\u4e3a\u7a7a\u4e14\u4e0d\u7b49\u4e8e\u201c 0\u201d\uff0c\u5219\u5c06\u4e0d\u4fdd\u5b58\u8be5\u54cd\u5e94\u5230\u7f13\u5b58\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1aproxy_no_cache string;\n\n\u4e0a\u4e0b\u6587\uff1ahttp\u3001server\u3001location\n\n\u793a\u4f8b\uff1aproxy_no_cache $http_pragma    $http_authorization;\n\n")),(0,l.kt)("h3",{id:"proxy_cache_bypass"},"proxy_cache_bypass"),(0,l.kt)("p",null,"\u5b9a\u4e49\u6761\u4ef6\uff0c\u5728\u8be5\u6761\u4ef6\u4e0b\u5c06\u4e0d\u4f1a\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\u54cd\u5e94\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\u8bed\u6cd5\uff1aproxy_cache_bypass string;\n\n\u4e0a\u4e0b\u6587\uff1ahttp\u3001server\u3001location\n\n\u793a\u4f8b\uff1aproxy_cache_bypass $http_pragma    $http_authorization;\n\n")),(0,l.kt)("h3",{id:"upstream_cache_status-\u53d8\u91cf"},"upstream_cache_status \u53d8\u91cf"),(0,l.kt)("p",null,"\u5b83\u5b58\u50a8\u4e86\u7f13\u5b58\u662f\u5426\u547d\u4e2d\u7684\u4fe1\u606f\uff0c\u4f1a\u8bbe\u7f6e\u5728\u54cd\u5e94\u5934\u4fe1\u606f\u4e2d\uff0c\u5728\u8c03\u8bd5\u4e2d\u975e\u5e38\u6709\u7528\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"MISS: \u672a\u547d\u4e2d\u7f13\u5b58\nHIT\uff1a \u547d\u4e2d\u7f13\u5b58\nEXPIRED: \u7f13\u5b58\u8fc7\u671f\nSTALE: \u547d\u4e2d\u4e86\u9648\u65e7\u7f13\u5b58\nREVALIDDATED: Nginx\u9a8c\u8bc1\u9648\u65e7\u7f13\u5b58\u4f9d\u7136\u6709\u6548\nUPDATING: \u5185\u5bb9\u9648\u65e7\uff0c\u4f46\u6b63\u5728\u66f4\u65b0\nBYPASS: X\u54cd\u5e94\u4ece\u539f\u59cb\u670d\u52a1\u5668\u83b7\u53d6\n")),(0,l.kt)("h3",{id:"\u914d\u7f6e\u5b9e\u4f8b-1"},"\u914d\u7f6e\u5b9e\u4f8b"),(0,l.kt)("p",null,"\u6211\u4eec\u628a ",(0,l.kt)("inlineCode",{parentName:"p"},"121.42.11.34")," \u670d\u52a1\u5668\u4f5c\u4e3a\u4e0a\u6e38\u670d\u52a1\u5668\uff0c\u505a\u5982\u4e0b\u914d\u7f6e\uff08 ",(0,l.kt)("inlineCode",{parentName:"p"},"/etc/nginx/conf.d/cache.conf")," \uff09\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"server {\n  listen 1010;\n  root /usr/share/nginx/html/1010;\n  location / {\n    index index.html;\n  }\n}\n\nserver {\n  listen 1020;\n  root /usr/share/nginx/html/1020;\n  location / {\n    index index.html;\n  }\n}\n\n")),(0,l.kt)("p",null,"\u628a ",(0,l.kt)("inlineCode",{parentName:"p"},"121.5.180.193")," \u670d\u52a1\u5668\u4f5c\u4e3a\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u505a\u5982\u4e0b\u914d\u7f6e\uff08 ",(0,l.kt)("inlineCode",{parentName:"p"},"/etc/nginx/conf.d/cache.conf")," \uff09\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"proxy_cache_path /etc/nginx/cache_temp levels=2:2 keys_zone=cache_zone:30m max_size=2g inactive=60m use_temp_path=off;\n\nupstream cache_server{\n  server 121.42.11.34:1010;\n  server 121.42.11.34:1020;\n}\n\nserver {\n  listen 80;\n  server_name cache.lion.club;\n  location / {\n    proxy_cache cache_zone; # \u8bbe\u7f6e\u7f13\u5b58\u5185\u5b58\uff0c\u4e0a\u9762\u914d\u7f6e\u4e2d\u5df2\u7ecf\u5b9a\u4e49\u597d\u7684\n    proxy_cache_valid 200 5m; # \u7f13\u5b58\u72b6\u6001\u4e3a200\u7684\u8bf7\u6c42\uff0c\u7f13\u5b58\u65f6\u957f\u4e3a5\u5206\u949f\n    proxy_cache_key $request_uri; # \u7f13\u5b58\u6587\u4ef6\u7684key\u4e3a\u8bf7\u6c42\u7684URI\n    add_header Nginx-Cache-Status $upstream_cache_status # \u628a\u7f13\u5b58\u72b6\u6001\u8bbe\u7f6e\u4e3a\u5934\u90e8\u4fe1\u606f\uff0c\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\n    proxy_pass http://cache_server; # \u4ee3\u7406\u8f6c\u53d1\n  }\n}\n\n")),(0,l.kt)("p",null,"\u7f13\u5b58\u5c31\u662f\u8fd9\u6837\u914d\u7f6e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 ",(0,l.kt)("inlineCode",{parentName:"p"},"/etc/nginx/cache_temp")," \u8def\u5f84\u4e0b\u627e\u5230\u76f8\u5e94\u7684\u7f13\u5b58\u6587\u4ef6\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5bf9\u4e8e\u4e00\u4e9b\u5b9e\u65f6\u6027\u8981\u6c42\u975e\u5e38\u9ad8\u7684\u9875\u9762\u6216\u6570\u636e\u6765\u8bf4\uff0c\u5c31\u4e0d\u5e94\u8be5\u53bb\u8bbe\u7f6e\u7f13\u5b58\uff0c\u4e0b\u9762\u6765\u770b\u770b\u5982\u4f55\u914d\u7f6e\u4e0d\u7f13\u5b58\u7684\u5185\u5bb9\u3002")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'...\n\nserver {\n  listen 80;\n  server_name cache.lion.club;\n  # URI \u4e2d\u540e\u7f00\u4e3a .txt \u6216 .text \u7684\u8bbe\u7f6e\u53d8\u91cf\u503c\u4e3a "no cache"\n  if ($request_uri ~ \\.(txt|text)$) {\n    set $cache_name "no cache"\n  }\n  \n  location / {\n    proxy_no_cache $cache_name; # \u5224\u65ad\u8be5\u53d8\u91cf\u662f\u5426\u6709\u503c\uff0c\u5982\u679c\u6709\u503c\u5219\u4e0d\u8fdb\u884c\u7f13\u5b58\uff0c\u5982\u679c\u6ca1\u6709\u503c\u5219\u8fdb\u884c\u7f13\u5b58\n    proxy_cache cache_zone; # \u8bbe\u7f6e\u7f13\u5b58\u5185\u5b58\n    proxy_cache_valid 200 5m; # \u7f13\u5b58\u72b6\u6001\u4e3a200\u7684\u8bf7\u6c42\uff0c\u7f13\u5b58\u65f6\u957f\u4e3a5\u5206\u949f\n    proxy_cache_key $request_uri; # \u7f13\u5b58\u6587\u4ef6\u7684key\u4e3a\u8bf7\u6c42\u7684URI\n    add_header Nginx-Cache-Status $upstream_cache_status # \u628a\u7f13\u5b58\u72b6\u6001\u8bbe\u7f6e\u4e3a\u5934\u90e8\u4fe1\u606f\uff0c\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\n    proxy_pass http://cache_server; # \u4ee3\u7406\u8f6c\u53d1\n  }\n}\n')),(0,l.kt)("h2",{id:"7-\u914d\u7f6ehttps"},"7. \u914d\u7f6eHTTPS"),(0,l.kt)("p",null,"\u5728\u5b66\u4e60\u5982\u4f55\u914d\u7f6e ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTPS")," \u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u7b80\u5355\u56de\u987e\u4e0b ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTPS")," \u7684\u5de5\u4f5c\u6d41\u7a0b\u662f\u600e\u4e48\u6837\u7684\uff1f\u5b83\u662f\u5982\u4f55\u8fdb\u884c\u52a0\u5bc6\u4fdd\u8bc1\u5b89\u5168\u7684\uff1f"),(0,l.kt)("h3",{id:"https-\u5de5\u4f5c\u6d41\u7a0b"},"HTTPS \u5de5\u4f5c\u6d41\u7a0b"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5ba2\u6237\u7aef\uff08\u6d4f\u89c8\u5668\uff09\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"li"},"https://www.baidu.com")," \u767e\u5ea6\u7f51\u7ad9\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u767e\u5ea6\u670d\u52a1\u5668\u8fd4\u56de ",(0,l.kt)("inlineCode",{parentName:"li"},"HTTPS")," \u4f7f\u7528\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"CA")," \u8bc1\u4e66\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u6d4f\u89c8\u5668\u9a8c\u8bc1 ",(0,l.kt)("inlineCode",{parentName:"li"},"CA")," \u8bc1\u4e66\u662f\u5426\u4e3a\u5408\u6cd5\u8bc1\u4e66\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u9a8c\u8bc1\u901a\u8fc7\uff0c\u8bc1\u4e66\u5408\u6cd5\uff0c\u751f\u6210\u4e00\u4e32\u968f\u673a\u6570\u5e76\u4f7f\u7528\u516c\u94a5\uff08\u8bc1\u4e66\u4e2d\u63d0\u4f9b\u7684\uff09\u8fdb\u884c\u52a0\u5bc6\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u53d1\u9001\u516c\u94a5\u52a0\u5bc6\u540e\u7684\u968f\u673a\u6570\u7ed9\u767e\u5ea6\u670d\u52a1\u5668\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u767e\u5ea6\u670d\u52a1\u5668\u62ff\u5230\u5bc6\u6587\uff0c\u901a\u8fc7\u79c1\u94a5\u8fdb\u884c\u89e3\u5bc6\uff0c\u83b7\u53d6\u5230\u968f\u673a\u6570\uff08\u516c\u94a5\u52a0\u5bc6\uff0c\u79c1\u94a5\u89e3\u5bc6\uff0c\u53cd\u4e4b\u4e5f\u53ef\u4ee5\uff09\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u767e\u5ea6\u670d\u52a1\u5668\u628a\u8981\u53d1\u9001\u7ed9\u6d4f\u89c8\u5668\u7684\u5185\u5bb9\uff0c\u4f7f\u7528\u968f\u673a\u6570\u8fdb\u884c\u52a0\u5bc6\u540e\u4f20\u8f93\u7ed9\u6d4f\u89c8\u5668\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u6b64\u65f6\u6d4f\u89c8\u5668\u53ef\u4ee5\u4f7f\u7528\u968f\u673a\u6570\u8fdb\u884c\u89e3\u5bc6\uff0c\u83b7\u53d6\u5230\u670d\u52a1\u5668\u7684\u771f\u5b9e\u4f20\u8f93\u5185\u5bb9\uff1b")),(0,l.kt)("p",null,"\u8fd9\u5c31\u662f ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTPS")," \u7684\u57fa\u672c\u8fd0\u4f5c\u539f\u7406\uff0c\u4f7f\u7528\u5bf9\u79f0\u52a0\u5bc6\u548c\u975e\u5bf9\u79f0\u673a\u5bc6\u914d\u5408\u4f7f\u7528\uff0c\u4fdd\u8bc1\u4f20\u8f93\u5185\u5bb9\u7684\u5b89\u5168\u6027\u3002"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://juejin.cn/post/6844904148601667598#heading-37"},"\u5173\u4e8eHTTPS\u66f4\u591a\u77e5\u8bc6\uff0c\u53ef\u4ee5\u67e5\u770b\u53e6\u5916\u4e00\u7bc7\u6587\u7ae0\u300a\u5b66\u4e60 HTTP \u534f\u8bae\u300b"),"\u3002"),(0,l.kt)("h3",{id:"\u914d\u7f6e\u8bc1\u4e66"},"\u914d\u7f6e\u8bc1\u4e66"),(0,l.kt)("p",null,"\u4e0b\u8f7d\u8bc1\u4e66\u7684\u538b\u7f29\u6587\u4ef6\uff0c\u91cc\u9762\u6709\u4e2a ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u6587\u4ef6\u5939\uff0c\u628a ",(0,l.kt)("inlineCode",{parentName:"p"},"xxx.crt")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"xxx.key")," \u6587\u4ef6\u62f7\u8d1d\u5230\u670d\u52a1\u5668\u76ee\u5f55\uff0c\u518d\u8fdb\u884c\u5982\u4e0b\u914d\u7f6e\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"server {\n  listen 443 ssl http2 default_server;   # SSL \u8bbf\u95ee\u7aef\u53e3\u53f7\u4e3a 443\n  server_name lion.club;         # \u586b\u5199\u7ed1\u5b9a\u8bc1\u4e66\u7684\u57df\u540d(\u6211\u8fd9\u91cc\u662f\u968f\u4fbf\u5199\u7684)\n  ssl_certificate /etc/nginx/https/lion.club_bundle.crt;   # \u8bc1\u4e66\u5730\u5740\n  ssl_certificate_key /etc/nginx/https/lion.club.key;      # \u79c1\u94a5\u5730\u5740\n  ssl_session_timeout 10m;\n  ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # \u652f\u6301ssl\u534f\u8bae\u7248\u672c\uff0c\u9ed8\u8ba4\u4e3a\u540e\u4e09\u4e2a\uff0c\u4e3b\u6d41\u7248\u672c\u662f[TLSv1.2]\n \n  location / {\n    root         /usr/share/nginx/html;\n    index        index.html index.htm;\n  }\n}\n\n# ---------HTTP\u8bf7\u6c42\u8f6cHTTPS-------------\nserver {\n    # \u76d1\u542cHTTP\u9ed8\u8ba4\u768480\u7aef\u53e3\n    listen 80;\n    # \u5982\u679c80\u7aef\u53e3\u51fa\u73b0\u8bbf\u95ee\u8be5\u57df\u540d\u7684\u8bf7\u6c42\n    server_name www.xxx.com;\n    # \u5c06\u8bf7\u6c42\u6539\u5199\u4e3aHTTPS\uff08\u8fd9\u91cc\u5199\u4f60\u914d\u7f6e\u4e86HTTPS\u7684\u57df\u540d\uff09\n    rewrite ^(.*)$ https://www.xxx.com;\n}\n")),(0,l.kt)("p",null,"\u5982\u6b64\u914d\u7f6e\u540e\u5c31\u80fd\u6b63\u5e38\u8bbf\u95ee ",(0,l.kt)("inlineCode",{parentName:"p"},"HTTPS")," \u7248\u7684\u7f51\u7ad9\u4e86\u3002"),(0,l.kt)("h2",{id:"8-nginx-\u67b6\u6784"},"8. Nginx \u67b6\u6784"),(0,l.kt)("h3",{id:"\u8fdb\u7a0b\u7ed3\u6784"},"\u8fdb\u7a0b\u7ed3\u6784"),(0,l.kt)("p",null,"\u591a\u8fdb\u7a0b\u7ed3\u6784 ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u7684\u8fdb\u7a0b\u6a21\u578b\u56fe\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1be5d62fb185454d825a56bf03e7dcd5~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:"\u672a\u547d\u540d\u6587\u4ef6.png"})),(0,l.kt)("p",null,"\u591a\u8fdb\u7a0b\u4e2d\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u8fdb\u7a0b\u67b6\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u4f1a\u6709\u4e00\u4e2a\u7236\u8fdb\u7a0b\uff08 ",(0,l.kt)("inlineCode",{parentName:"p"},"Master Process")," \uff09\uff0c\u5b83\u4f1a\u6709\u5f88\u591a\u5b50\u8fdb\u7a0b\uff08 ",(0,l.kt)("inlineCode",{parentName:"p"},"Child Processes")," \uff09\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"Master Process\n")),(0,l.kt)("p",{parentName:"li"}," \u7528\u6765\u7ba1\u7406\u5b50\u8fdb\u7a0b\u7684\uff0c\u5176\u672c\u8eab\u5e76\u4e0d\u771f\u6b63\u5904\u7406\u7528\u6237\u8bf7\u6c42\u3002"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u67d0\u4e2a\u5b50\u8fdb\u7a0b ",(0,l.kt)("inlineCode",{parentName:"li"},"down")," \u6389\u7684\u8bdd\uff0c\u5b83\u4f1a\u5411 ",(0,l.kt)("inlineCode",{parentName:"li"},"Master")," \u8fdb\u7a0b\u53d1\u9001\u4e00\u6761\u6d88\u606f\uff0c\u8868\u660e\u81ea\u5df1\u4e0d\u53ef\u7528\u4e86\uff0c\u6b64\u65f6 ",(0,l.kt)("inlineCode",{parentName:"li"},"Master")," \u8fdb\u7a0b\u4f1a\u53bb\u65b0\u8d77\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u67d0\u4e2a\u914d\u7f6e\u6587\u4ef6\u88ab\u4fee\u6539\u4e86 ",(0,l.kt)("inlineCode",{parentName:"li"},"Master")," \u8fdb\u7a0b\u4f1a\u53bb\u901a\u77e5 ",(0,l.kt)("inlineCode",{parentName:"li"},"work")," \u8fdb\u7a0b\u83b7\u53d6\u65b0\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u8fd9\u4e5f\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684\u70ed\u90e8\u7f72\u3002"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5b50\u8fdb\u7a0b\u95f4\u662f\u901a\u8fc7\u5171\u4eab\u5185\u5b58\u7684\u65b9\u5f0f\u8fdb\u884c\u901a\u4fe1\u7684\u3002"))),(0,l.kt)("h3",{id:"\u914d\u7f6e\u6587\u4ef6\u91cd\u8f7d\u539f\u7406"},"\u914d\u7f6e\u6587\u4ef6\u91cd\u8f7d\u539f\u7406"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"reload")," \u91cd\u8f7d\u914d\u7f6e\u6587\u4ef6\u7684\u6d41\u7a0b\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5411 ",(0,l.kt)("inlineCode",{parentName:"li"},"master")," \u8fdb\u7a0b\u53d1\u9001 ",(0,l.kt)("inlineCode",{parentName:"li"},"HUP")," \u4fe1\u53f7\uff08 ",(0,l.kt)("inlineCode",{parentName:"li"},"reload")," \u547d\u4ee4\uff09\uff1b"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"master")," \u8fdb\u7a0b\u68c0\u67e5\u914d\u7f6e\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff1b"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"master")," \u8fdb\u7a0b\u6253\u5f00\u76d1\u542c\u7aef\u53e3\uff1b"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"master")," \u8fdb\u7a0b\u4f7f\u7528\u65b0\u7684\u914d\u7f6e\u6587\u4ef6\u542f\u52a8\u65b0\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"worker")," \u5b50\u8fdb\u7a0b\uff1b"),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"master")," \u8fdb\u7a0b\u5411\u8001\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"worker")," \u5b50\u8fdb\u7a0b\u53d1\u9001 ",(0,l.kt)("inlineCode",{parentName:"li"},"QUIT")," \u4fe1\u53f7\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u8001\u7684 ",(0,l.kt)("inlineCode",{parentName:"li"},"worker")," \u8fdb\u7a0b\u5173\u95ed\u76d1\u542c\u53e5\u67c4\uff0c\u5904\u7406\u5b8c\u5f53\u524d\u8fde\u63a5\u540e\u5173\u95ed\u8fdb\u7a0b\uff1b"),(0,l.kt)("li",{parentName:"ol"},"\u6574\u4e2a\u8fc7\u7a0b ",(0,l.kt)("inlineCode",{parentName:"li"},"Nginx")," \u59cb\u7ec8\u5904\u4e8e\u5e73\u7a33\u8fd0\u884c\u4e2d\uff0c\u5b9e\u73b0\u4e86\u5e73\u6ed1\u5347\u7ea7\uff0c\u7528\u6237\u65e0\u611f\u77e5\uff1b")),(0,l.kt)("h3",{id:"nginx-\u6a21\u5757\u5316\u7ba1\u7406\u673a\u5236"},"Nginx \u6a21\u5757\u5316\u7ba1\u7406\u673a\u5236"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u7684\u5185\u90e8\u7ed3\u6784\u662f\u7531\u6838\u5fc3\u90e8\u5206\u548c\u4e00\u7cfb\u5217\u7684\u529f\u80fd\u6a21\u5757\u6240\u7ec4\u6210\u3002\u8fd9\u6837\u5212\u5206\u662f\u4e3a\u4e86\u4f7f\u5f97\u6bcf\u4e2a\u6a21\u5757\u7684\u529f\u80fd\u76f8\u5bf9\u7b80\u5355\uff0c\u4fbf\u4e8e\u5f00\u53d1\uff0c\u540c\u65f6\u4e5f\u4fbf\u4e8e\u5bf9\u7cfb\u7edf\u8fdb\u884c\u529f\u80fd\u6269\u5c55\u3002",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx")," \u7684\u6a21\u5757\u662f\u4e92\u76f8\u72ec\u7acb\u7684,\u4f4e\u8026\u5408\u9ad8\u5185\u805a\u3002\n",(0,l.kt)("img",{parentName:"p",src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7c0d0801228d409b8fc202df83a2233d~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:"image.png"})),(0,l.kt)("h2",{id:"9-nginx\u7684\u9ad8\u53ef\u7528"},"9. Nginx\u7684\u9ad8\u53ef\u7528"),(0,l.kt)("p",null,"  \u7ebf\u4e0a\u5982\u679c\u91c7\u7528\u5355\u4e2a\u8282\u70b9\u7684\u65b9\u5f0f\u90e8\u7f72",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx"),"\uff0c\u96be\u514d\u4f1a\u51fa\u73b0\u5929\u707e\u4eba\u7978\uff0c\u6bd4\u5982\u7cfb\u7edf\u5f02\u5e38\u3001\u7a0b\u5e8f\u5b95\u673a\u3001\u670d\u52a1\u5668\u65ad\u7535\u3001\u673a\u623f\u7206\u70b8\u3001\u5730\u7403\u6bc1\u706d....\u54c8\u54c8\u54c8\uff0c\u5938\u5f20\u4e86\u3002\u4f46\u5b9e\u9645\u751f\u4ea7\u73af\u5883\u4e2d\u786e\u5b9e\u5b58\u5728\u9690\u60a3\u95ee\u9898\uff0c\u7531\u4e8e",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx"),"\u4f5c\u4e3a\u6574\u4e2a\u7cfb\u7edf\u7684\u7f51\u5173\u5c42\u63a5\u5165\u5916\u90e8\u6d41\u91cf\uff0c\u6240\u4ee5\u4e00\u65e6",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx"),"\u5b95\u673a\uff0c\u6700\u7ec8\u5c31\u4f1a\u5bfc\u81f4\u6574\u4e2a\u7cfb\u7edf\u4e0d\u53ef\u7528\uff0c\u8fd9\u65e0\u7591\u5bf9\u4e8e\u7528\u6237\u7684\u4f53\u9a8c\u611f\u662f\u6781\u5dee\u7684\uff0c\u56e0\u6b64\u4e5f\u5f97\u4fdd\u969c",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx"),"\u9ad8\u53ef\u7528\u7684\u7279\u6027\u3002"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u63a5\u4e0b\u6765\u5219\u4f1a\u901a\u8fc7",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived"),"\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"VIP"),"\u673a\u5236\uff0c\u5b9e\u73b0",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx"),"\u7684\u9ad8\u53ef\u7528\u3002\n",(0,l.kt)("inlineCode",{parentName:"p"},"VIP"),"\u5e76\u4e0d\u662f\u53ea\u4f1a\u5458\u7684\u610f\u601d\uff0c\u800c\u662f\u6307",(0,l.kt)("inlineCode",{parentName:"p"},"Virtual IP"),"\uff0c\u5373\u865a\u62df",(0,l.kt)("inlineCode",{parentName:"p"},"IP"),"\u3002")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"keepalived"),"\u5728\u4e4b\u524d\u5355\u4f53\u67b6\u6784\u5f00\u53d1\u65f6\uff0c\u662f\u4e00\u4e2a\u7528\u7684\u8f83\u4e3a\u9891\u7e41\u7684\u9ad8\u53ef\u7528\u6280\u672f\uff0c\u6bd4\u5982",(0,l.kt)("inlineCode",{parentName:"p"},"MySQL\u3001Redis\u3001MQ\u3001Proxy\u3001Tomcat"),"\u7b49\u5404\u5904\u90fd\u4f1a\u901a\u8fc7",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived"),"\u63d0\u4f9b\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"VIP"),"\u673a\u5236\uff0c\u5b9e\u73b0\u5355\u8282\u70b9\u5e94\u7528\u7684\u9ad8\u53ef\u7528\u3002"),(0,l.kt)("h3",{id:"keepalived\u91cd\u542f\u811a\u672c\u53cc\u673a\u70ed\u5907\u642d\u5efa"},"Keepalived+\u91cd\u542f\u811a\u672c+\u53cc\u673a\u70ed\u5907\u642d\u5efa"),(0,l.kt)("p",null,"\u2460\u9996\u5148\u521b\u5efa\u4e00\u4e2a\u5bf9\u5e94\u7684\u76ee\u5f55\u5e76\u4e0b\u8f7d",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived"),"\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"Linux"),"\u4e2d\u5e76\u89e3\u538b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"[root@localhost]# mkdir /soft/keepalived && cd /soft/keepalived\n[root@localhost]# wget https://www.keepalived.org/software/keepalived-2.2.4.tar.gz\n[root@localhost]# tar -zxvf keepalived-2.2.4.tar.gz\n")),(0,l.kt)("p",null,"\u2461\u8fdb\u5165\u89e3\u538b\u540e\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived"),"\u76ee\u5f55\u5e76\u6784\u5efa\u5b89\u88c5\u73af\u5883\uff0c\u7136\u540e\u7f16\u8bd1\u5e76\u5b89\u88c5\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"[root@localhost]# cd keepalived-2.2.4\n[root@localhost]# ./configure --prefix=/soft/keepalived/\n[root@localhost]# make && make install\n")),(0,l.kt)("p",null,"\u2462\u8fdb\u5165\u5b89\u88c5\u76ee\u5f55\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"/soft/keepalived/etc/keepalived/"),"\u5e76\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"[root@localhost]# cd /soft/keepalived/etc/keepalived/\n[root@localhost]# vi keepalived.conf\n")),(0,l.kt)("p",null,"\u2463\u7f16\u8f91\u4e3b\u673a\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived.conf"),"\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\uff0c\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'global_defs {\n    # \u81ea\u5e26\u7684\u90ae\u4ef6\u63d0\u9192\u670d\u52a1\uff0c\u5efa\u8bae\u7528\u72ec\u7acb\u7684\u76d1\u63a7\u6216\u7b2c\u4e09\u65b9SMTP\uff0c\u4e5f\u53ef\u9009\u62e9\u914d\u7f6e\u90ae\u4ef6\u53d1\u9001\u3002\n    notification_email {\n        root@localhost\n    }\n    notification_email_from root@localhost\n    smtp_server localhost\n    smtp_connect_timeout 30\n    # \u9ad8\u53ef\u7528\u96c6\u7fa4\u4e3b\u673a\u8eab\u4efd\u6807\u8bc6(\u96c6\u7fa4\u4e2d\u4e3b\u673a\u8eab\u4efd\u6807\u8bc6\u540d\u79f0\u4e0d\u80fd\u91cd\u590d\uff0c\u5efa\u8bae\u914d\u7f6e\u6210\u672c\u673aIP)\n    router_id 192.168.12.129 \n}\n\n# \u5b9a\u65f6\u8fd0\u884c\u7684\u811a\u672c\u6587\u4ef6\u914d\u7f6e\nvrrp_script check_nginx_pid_restart {\n    # \u4e4b\u524d\u7f16\u5199\u7684nginx\u91cd\u542f\u811a\u672c\u7684\u6240\u5728\u4f4d\u7f6e\n    script "/soft/scripts/keepalived/check_nginx_pid_restart.sh" \n    # \u6bcf\u95f4\u96943\u79d2\u6267\u884c\u4e00\u6b21\n    interval 3\n    # \u5982\u679c\u811a\u672c\u4e2d\u7684\u6761\u4ef6\u6210\u7acb\uff0c\u91cd\u542f\u4e00\u6b21\u5219\u6743\u91cd-20\n    weight -20\n}\n\n# \u5b9a\u4e49\u865a\u62df\u8def\u7531\uff0cVI_1\u4e3a\u865a\u62df\u8def\u7531\u7684\u6807\u793a\u7b26\uff08\u53ef\u81ea\u5b9a\u4e49\u540d\u79f0\uff09\nvrrp_instance VI_1 {\n    # \u5f53\u524d\u8282\u70b9\u7684\u8eab\u4efd\u6807\u8bc6\uff1a\u7528\u6765\u51b3\u5b9a\u4e3b\u4ece\uff08MASTER\u4e3a\u4e3b\u673a\uff0cBACKUP\u4e3a\u4ece\u673a\uff09\n    state MASTER\n    # \u7ed1\u5b9a\u865a\u62dfIP\u7684\u7f51\u7edc\u63a5\u53e3\uff0c\u6839\u636e\u81ea\u5df1\u7684\u673a\u5668\u7684\u7f51\u5361\u914d\u7f6e\n    interface ens33 \n    # \u865a\u62df\u8def\u7531\u7684ID\u53f7\uff0c\u4e3b\u4ece\u4e24\u4e2a\u8282\u70b9\u8bbe\u7f6e\u5fc5\u987b\u4e00\u6837\n    virtual_router_id 121\n    # \u586b\u5199\u672c\u673aIP\n    mcast_src_ip 192.168.12.129\n    # \u8282\u70b9\u6743\u91cd\u4f18\u5148\u7ea7\uff0c\u4e3b\u8282\u70b9\u8981\u6bd4\u4ece\u8282\u70b9\u4f18\u5148\u7ea7\u9ad8\n    priority 100\n    # \u4f18\u5148\u7ea7\u9ad8\u7684\u8bbe\u7f6enopreempt\uff0c\u89e3\u51b3\u5f02\u5e38\u6062\u590d\u540e\u518d\u6b21\u62a2\u5360\u9020\u6210\u7684\u8111\u88c2\u95ee\u9898\n    nopreempt\n    # \u7ec4\u64ad\u4fe1\u606f\u53d1\u9001\u95f4\u9694\uff0c\u4e24\u4e2a\u8282\u70b9\u8bbe\u7f6e\u5fc5\u987b\u4e00\u6837\uff0c\u9ed8\u8ba41s\uff08\u7c7b\u4f3c\u4e8e\u5fc3\u8df3\u68c0\u6d4b\uff09\n    advert_int 1\n    authentication {\n        auth_type PASS\n        auth_pass 1111\n    }\n    # \u5c06track_script\u5757\u52a0\u5165instance\u914d\u7f6e\u5757\n    track_script {\n        # \u6267\u884cNginx\u76d1\u63a7\u7684\u811a\u672c\n        check_nginx_pid_restart\n    }\n\n    virtual_ipaddress {\n        # \u865a\u62dfIP(VIP)\uff0c\u4e5f\u53ef\u6269\u5c55\uff0c\u53ef\u914d\u7f6e\u591a\u4e2a\u3002\n        192.168.12.111\n    }\n}\n')),(0,l.kt)("p",null,"\u2464\u514b\u9686\u4e00\u53f0\u4e4b\u524d\u7684\u865a\u62df\u673a\u4f5c\u4e3a\u4ece\uff08\u5907\uff09\u673a\uff0c\u7f16\u8f91\u4ece\u673a\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived.conf"),"\u6587\u4ef6\uff0c\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'global_defs {\n    # \u81ea\u5e26\u7684\u90ae\u4ef6\u63d0\u9192\u670d\u52a1\uff0c\u5efa\u8bae\u7528\u72ec\u7acb\u7684\u76d1\u63a7\u6216\u7b2c\u4e09\u65b9SMTP\uff0c\u4e5f\u53ef\u9009\u62e9\u914d\u7f6e\u90ae\u4ef6\u53d1\u9001\u3002\n    notification_email {\n        root@localhost\n    }\n    notification_email_from root@localhost\n    smtp_server localhost\n    smtp_connect_timeout 30\n    # \u9ad8\u53ef\u7528\u96c6\u7fa4\u4e3b\u673a\u8eab\u4efd\u6807\u8bc6(\u96c6\u7fa4\u4e2d\u4e3b\u673a\u8eab\u4efd\u6807\u8bc6\u540d\u79f0\u4e0d\u80fd\u91cd\u590d\uff0c\u5efa\u8bae\u914d\u7f6e\u6210\u672c\u673aIP)\n    router_id 192.168.12.130 \n}\n\n# \u5b9a\u65f6\u8fd0\u884c\u7684\u811a\u672c\u6587\u4ef6\u914d\u7f6e\nvrrp_script check_nginx_pid_restart {\n    # \u4e4b\u524d\u7f16\u5199\u7684nginx\u91cd\u542f\u811a\u672c\u7684\u6240\u5728\u4f4d\u7f6e\n    script "/soft/scripts/keepalived/check_nginx_pid_restart.sh" \n    # \u6bcf\u95f4\u96943\u79d2\u6267\u884c\u4e00\u6b21\n    interval 3\n    # \u5982\u679c\u811a\u672c\u4e2d\u7684\u6761\u4ef6\u6210\u7acb\uff0c\u91cd\u542f\u4e00\u6b21\u5219\u6743\u91cd-20\n    weight -20\n}\n\n# \u5b9a\u4e49\u865a\u62df\u8def\u7531\uff0cVI_1\u4e3a\u865a\u62df\u8def\u7531\u7684\u6807\u793a\u7b26\uff08\u53ef\u81ea\u5b9a\u4e49\u540d\u79f0\uff09\nvrrp_instance VI_1 {\n    # \u5f53\u524d\u8282\u70b9\u7684\u8eab\u4efd\u6807\u8bc6\uff1a\u7528\u6765\u51b3\u5b9a\u4e3b\u4ece\uff08MASTER\u4e3a\u4e3b\u673a\uff0cBACKUP\u4e3a\u4ece\u673a\uff09\n    state BACKUP\n    # \u7ed1\u5b9a\u865a\u62dfIP\u7684\u7f51\u7edc\u63a5\u53e3\uff0c\u6839\u636e\u81ea\u5df1\u7684\u673a\u5668\u7684\u7f51\u5361\u914d\u7f6e\n    interface ens33 \n    # \u865a\u62df\u8def\u7531\u7684ID\u53f7\uff0c\u4e3b\u4ece\u4e24\u4e2a\u8282\u70b9\u8bbe\u7f6e\u5fc5\u987b\u4e00\u6837\n    virtual_router_id 121\n    # \u586b\u5199\u672c\u673aIP\n    mcast_src_ip 192.168.12.130\n    # \u8282\u70b9\u6743\u91cd\u4f18\u5148\u7ea7\uff0c\u4e3b\u8282\u70b9\u8981\u6bd4\u4ece\u8282\u70b9\u4f18\u5148\u7ea7\u9ad8\n    priority 90\n    # \u4f18\u5148\u7ea7\u9ad8\u7684\u8bbe\u7f6enopreempt\uff0c\u89e3\u51b3\u5f02\u5e38\u6062\u590d\u540e\u518d\u6b21\u62a2\u5360\u9020\u6210\u7684\u8111\u88c2\u95ee\u9898\n    nopreempt\n    # \u7ec4\u64ad\u4fe1\u606f\u53d1\u9001\u95f4\u9694\uff0c\u4e24\u4e2a\u8282\u70b9\u8bbe\u7f6e\u5fc5\u987b\u4e00\u6837\uff0c\u9ed8\u8ba41s\uff08\u7c7b\u4f3c\u4e8e\u5fc3\u8df3\u68c0\u6d4b\uff09\n    advert_int 1\n    authentication {\n        auth_type PASS\n        auth_pass 1111\n    }\n    # \u5c06track_script\u5757\u52a0\u5165instance\u914d\u7f6e\u5757\n    track_script {\n        # \u6267\u884cNginx\u76d1\u63a7\u7684\u811a\u672c\n        check_nginx_pid_restart\n    }\n\n    virtual_ipaddress {\n        # \u865a\u62dfIP(VIP)\uff0c\u4e5f\u53ef\u6269\u5c55\uff0c\u53ef\u914d\u7f6e\u591a\u4e2a\u3002\n        192.168.12.111\n    }\n}\n')),(0,l.kt)("p",null,"\u2465\u65b0\u5efa",(0,l.kt)("inlineCode",{parentName:"p"},"scripts"),"\u76ee\u5f55\u5e76\u7f16\u5199",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx"),"\u7684\u91cd\u542f\u811a\u672c\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"check_nginx_pid_restart.sh"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"[root@localhost]# mkdir /soft/scripts /soft/scripts/keepalived\n[root@localhost]# touch /soft/scripts/keepalived/check_nginx_pid_restart.sh\n[root@localhost]# vi /soft/scripts/keepalived/check_nginx_pid_restart.sh\n\n#!/bin/sh\n# \u901a\u8fc7ps\u6307\u4ee4\u67e5\u8be2\u540e\u53f0\u7684nginx\u8fdb\u7a0b\u6570\uff0c\u5e76\u5c06\u5176\u4fdd\u5b58\u5728\u53d8\u91cfnginx_number\u4e2d\nnginx_number=`ps -C nginx --no-header | wc -l`\n# \u5224\u65ad\u540e\u53f0\u662f\u5426\u8fd8\u6709Nginx\u8fdb\u7a0b\u5728\u8fd0\u884c\nif [ $nginx_number -eq 0 ];then\n    # \u5982\u679c\u540e\u53f0\u67e5\u8be2\u4e0d\u5230`Nginx`\u8fdb\u7a0b\u5b58\u5728\uff0c\u5219\u6267\u884c\u91cd\u542f\u6307\u4ee4\n    /soft/nginx/sbin/nginx -c /soft/nginx/conf/nginx.conf\n    # \u91cd\u542f\u540e\u7b49\u5f851s\u540e\uff0c\u518d\u6b21\u67e5\u8be2\u540e\u53f0\u8fdb\u7a0b\u6570\n    sleep 1\n    # \u5982\u679c\u91cd\u542f\u540e\u4f9d\u65e7\u65e0\u6cd5\u67e5\u8be2\u5230nginx\u8fdb\u7a0b\n    if [ `ps -C nginx --no-header | wc -l` -eq 0 ];then\n        # \u5c06keepalived\u4e3b\u673a\u4e0b\u7ebf\uff0c\u5c06\u865a\u62dfIP\u6f02\u79fb\u7ed9\u4ece\u673a\uff0c\u4ece\u673a\u4e0a\u7ebf\u63a5\u7ba1Nginx\u670d\u52a1\n        systemctl stop keepalived.service\n    fi\nfi\n")),(0,l.kt)("p",null,"\u2466\u7f16\u5199\u7684\u811a\u672c\u6587\u4ef6\u9700\u8981\u66f4\u6539\u7f16\u7801\u683c\u5f0f\uff0c\u5e76\u8d4b\u4e88\u6267\u884c\u6743\u9650\uff0c\u5426\u5219\u53ef\u80fd\u6267\u884c\u5931\u8d25\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"[root@localhost]# vi /soft/scripts/keepalived/check_nginx_pid_restart.sh\n\n:set fileformat=unix # \u5728vi\u547d\u4ee4\u91cc\u9762\u6267\u884c\uff0c\u4fee\u6539\u7f16\u7801\u683c\u5f0f\n:set ff # \u67e5\u770b\u4fee\u6539\u540e\u7684\u7f16\u7801\u683c\u5f0f\n\n[root@localhost]# chmod +x /soft/scripts/keepalived/check_nginx_pid_restart.sh\n")),(0,l.kt)("p",null,"\u2467\u7531\u4e8e\u5b89\u88c5",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived"),"\u65f6\uff0c\u662f\u81ea\u5b9a\u4e49\u7684\u5b89\u88c5\u4f4d\u7f6e\uff0c\u56e0\u6b64\u9700\u8981\u62f7\u8d1d\u4e00\u4e9b\u6587\u4ef6\u5230\u7cfb\u7edf\u76ee\u5f55\u4e2d\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"[root@localhost]# mkdir /etc/keepalived/\n[root@localhost]# cp /soft/keepalived/etc/keepalived/keepalived.conf /etc/keepalived/\n[root@localhost]# cp /soft/keepalived/keepalived-2.2.4/keepalived/etc/init.d/keepalived /etc/init.d/\n[root@localhost]# cp /soft/keepalived/etc/sysconfig/keepalived /etc/sysconfig/\n")),(0,l.kt)("p",null,"\u2468\u5c06",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived"),"\u52a0\u5165\u7cfb\u7edf\u670d\u52a1\u5e76\u8bbe\u7f6e\u5f00\u542f\u81ea\u542f\u52a8\uff0c\u7136\u540e\u6d4b\u8bd5\u542f\u52a8\u662f\u5426\u6b63\u5e38\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"[root@localhost]# chkconfig keepalived on\n[root@localhost]# systemctl daemon-reload\n[root@localhost]# systemctl enable keepalived.service\n[root@localhost]# systemctl start keepalived.service\n\n\u5176\u4ed6\u547d\u4ee4\uff1a\nsystemctl disable keepalived.service # \u7981\u6b62\u5f00\u673a\u81ea\u52a8\u542f\u52a8\nsystemctl restart keepalived.service # \u91cd\u542fkeepalived\nsystemctl stop keepalived.service # \u505c\u6b62keepalived\ntail -f /var/log/messages # \u67e5\u770bkeepalived\u8fd0\u884c\u65f6\u65e5\u5fd7\n")),(0,l.kt)("p",null,"\u2469\u6700\u540e\u6d4b\u8bd5\u4e00\u4e0b",(0,l.kt)("inlineCode",{parentName:"p"},"VIP"),"\u662f\u5426\u751f\u6548\uff0c\u901a\u8fc7\u67e5\u770b\u672c\u673a\u662f\u5426\u6210\u529f\u6302\u8f7d\u865a\u62df",(0,l.kt)("inlineCode",{parentName:"p"},"IP"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"[root@localhost]# ip addr\n")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20230201105251601",src:t(3661).Z,width:"1053",height:"415"})),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u4ece\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u660e\u663e\u770b\u89c1\u865a\u62df",(0,l.kt)("inlineCode",{parentName:"p"},"IP"),"\u5df2\u7ecf\u6210\u529f\u6302\u8f7d\uff0c\u4f46\u53e6\u5916\u4e00\u53f0\u673a\u5668",(0,l.kt)("inlineCode",{parentName:"p"},"192.168.12.130"),"\u5e76\u4e0d\u4f1a\u6302\u8f7d\u8fd9\u4e2a\u865a\u62df",(0,l.kt)("inlineCode",{parentName:"p"},"IP"),"\uff0c\u53ea\u6709\u5f53\u4e3b\u673a\u4e0b\u7ebf\u540e\uff0c\u4f5c\u4e3a\u4ece\u673a\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"192.168.12.130"),"\u624d\u4f1a\u4e0a\u7ebf\uff0c\u63a5\u66ff",(0,l.kt)("inlineCode",{parentName:"p"},"VIP"),"\u3002\u6700\u540e\u6d4b\u8bd5\u4e00\u4e0b\u5916\u7f51\u662f\u5426\u53ef\u4ee5\u6b63\u5e38\u4e0e",(0,l.kt)("inlineCode",{parentName:"p"},"VIP"),"\u901a\u4fe1\uff0c\u5373\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"Windows"),"\u4e2d\u76f4\u63a5",(0,l.kt)("inlineCode",{parentName:"p"},"ping VIP"),"\uff1a")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20230201105307630",src:t(8355).Z,width:"582",height:"255"})),(0,l.kt)("p",null,"\u5916\u90e8\u901a\u8fc7",(0,l.kt)("inlineCode",{parentName:"p"},"VIP"),"\u901a\u4fe1\u65f6\uff0c\u4e5f\u53ef\u4ee5\u6b63\u5e38",(0,l.kt)("inlineCode",{parentName:"p"},"Ping"),"\u901a\uff0c\u4ee3\u8868\u865a\u62df",(0,l.kt)("inlineCode",{parentName:"p"},"IP"),"\u914d\u7f6e\u6210\u529f\u3002"),(0,l.kt)("h3",{id:"nginx\u9ad8\u53ef\u7528\u6027\u6d4b\u8bd5"},"Nginx\u9ad8\u53ef\u7528\u6027\u6d4b\u8bd5"),(0,l.kt)("p",null,"  \u7ecf\u8fc7\u4e0a\u8ff0\u6b65\u9aa4\u540e\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived"),"\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"VIP"),"\u673a\u5236\u5df2\u7ecf\u642d\u5efa\u6210\u529f\uff0c\u5728\u4e0a\u4e2a\u9636\u6bb5\u4e2d\u4e3b\u8981\u505a\u4e86\u51e0\u4ef6\u4e8b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u4e00\u3001\u4e3a\u90e8\u7f72",(0,l.kt)("inlineCode",{parentName:"li"},"Nginx"),"\u7684\u673a\u5668\u6302\u8f7d\u4e86",(0,l.kt)("inlineCode",{parentName:"li"},"VIP"),"\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u4e8c\u3001\u901a\u8fc7",(0,l.kt)("inlineCode",{parentName:"li"},"keepalived"),"\u642d\u5efa\u4e86\u4e3b\u4ece\u53cc\u673a\u70ed\u5907\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u4e09\u3001\u901a\u8fc7",(0,l.kt)("inlineCode",{parentName:"li"},"keepalived"),"\u5b9e\u73b0\u4e86",(0,l.kt)("inlineCode",{parentName:"li"},"Nginx"),"\u5b95\u673a\u91cd\u542f\u3002")),(0,l.kt)("p",null,"\u7531\u4e8e\u524d\u9762\u6ca1\u6709\u57df\u540d\u7684\u539f\u56e0\uff0c\u56e0\u6b64\u6700\u521d",(0,l.kt)("inlineCode",{parentName:"p"},"server_name"),"\u914d\u7f6e\u7684\u662f\u5f53\u524d\u673a\u5668\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"IP"),"\uff0c\u6240\u4ee5\u9700\u7a0d\u5fae\u66f4\u6539\u4e00\u4e0b",(0,l.kt)("inlineCode",{parentName:"p"},"nginx.conf"),"\u7684\u914d\u7f6e\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"sever{\n    listen    80;\n    # \u8fd9\u91cc\u4ece\u673a\u5668\u7684\u672c\u5730IP\u6539\u4e3a\u865a\u62dfIP\n    server_name 192.168.12.111;\n    # \u5982\u679c\u8fd9\u91cc\u914d\u7f6e\u7684\u662f\u57df\u540d\uff0c\u90a3\u4e48\u5219\u5c06\u57df\u540d\u7684\u6620\u5c04\u914d\u7f6e\u6539\u4e3a\u865a\u62dfIP\n}\n")),(0,l.kt)("p",null,"\u6700\u540e\u6765\u5b9e\u9a8c\u4e00\u4e0b\u6548\u679c\uff1a "),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20230201105339842",src:t(8202).Z,width:"1155",height:"363"})),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u5728\u4e0a\u8ff0\u8fc7\u7a0b\u4e2d\uff0c\u9996\u5148\u5206\u522b\u542f\u52a8\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived\u3001nginx"),"\u670d\u52a1\uff0c\u7136\u540e\u901a\u8fc7\u624b\u52a8\u505c\u6b62",(0,l.kt)("inlineCode",{parentName:"p"},"nginx"),"\u7684\u65b9\u5f0f\u6a21\u62df\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx"),"\u5b95\u673a\u60c5\u51b5\uff0c\u8fc7\u4e86\u7247\u523b\u540e\u518d\u6b21\u67e5\u8be2\u540e\u53f0\u8fdb\u7a0b\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0",(0,l.kt)("inlineCode",{parentName:"p"},"nginx"),"\u4f9d\u65e7\u5b58\u6d3b\u3002")),(0,l.kt)("p",null,"\u4ece\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u4e0d\u96be\u53d1\u73b0\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived"),"\u5df2\u7ecf\u4e3a\u6211\u4eec\u5b9e\u73b0\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx"),"\u5b95\u673a\u540e\u81ea\u52a8\u91cd\u542f\u7684\u529f\u80fd\uff0c\u90a3\u4e48\u63a5\u7740\u518d\u6a21\u62df\u4e00\u4e0b\u670d\u52a1\u5668\u51fa\u73b0\u6545\u969c\u65f6\u7684\u60c5\u51b5\uff1a\n",(0,l.kt)("img",{alt:"image-20230201105415442",src:t(2913).Z,width:"950",height:"383"})),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u5728\u4e0a\u8ff0\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u624b\u52a8\u5173\u95ed",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived"),"\u670d\u52a1\u6a21\u62df\u4e86\u673a\u5668\u65ad\u7535\u3001\u786c\u4ef6\u635f\u574f\u7b49\u60c5\u51b5\uff08\u56e0\u4e3a\u673a\u5668\u65ad\u7535\u7b49\u60c5\u51b5=\u4e3b\u673a\u4e2d\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"keepalived"),"\u8fdb\u7a0b\u6d88\u5931\uff09\uff0c\u7136\u540e\u518d\u6b21\u67e5\u8be2\u4e86\u4e00\u4e0b\u672c\u673a\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"IP"),"\u4fe1\u606f\uff0c\u5f88\u660e\u663e\u4f1a\u770b\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"VIP"),"\u6d88\u5931\u4e86\uff01")),(0,l.kt)("p",null,"\u73b0\u5728\u518d\u5207\u6362\u5230\u53e6\u5916\u4e00\u53f0\u673a\u5668\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"192.168.12.130"),"\u6765\u770b\u770b\u60c5\u51b5\uff1a "),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20230201105444380",src:t(3751).Z,width:"943",height:"289"})),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u6b64\u523b\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u5728\u4e3b\u673a",(0,l.kt)("inlineCode",{parentName:"p"},"192.168.12.129"),"\u5b95\u673a\u540e\uff0cVIP\u81ea\u52a8\u4ece\u4e3b\u673a\u98d8\u79fb\u5230\u4e86\u4ece\u673a",(0,l.kt)("inlineCode",{parentName:"p"},"192.168.12.130"),"\u4e0a\uff0c\u800c\u6b64\u65f6\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u5c31\u6700\u7ec8\u4f1a\u6765\u5230",(0,l.kt)("inlineCode",{parentName:"p"},"130"),"\u8fd9\u53f0\u673a\u5668\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"Nginx"),"\u4e0a\u3002")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6700\u7ec8\uff0c\u5229\u7528",(0,l.kt)("inlineCode",{parentName:"strong"},"Keepalived"),"\u5bf9",(0,l.kt)("inlineCode",{parentName:"strong"},"Nginx"),"\u505a\u4e86\u4e3b\u4ece\u70ed\u5907\u4e4b\u540e\uff0c\u65e0\u8bba\u662f\u9047\u5230\u7ebf\u4e0a\u5b95\u673a\u8fd8\u662f\u673a\u623f\u65ad\u7535\u7b49\u5404\u7c7b\u6545\u969c\u65f6\uff0c\u90fd\u80fd\u591f\u786e\u4fdd\u5e94\u7528\u7cfb\u7edf\u80fd\u591f\u4e3a\u7528\u6237\u63d0\u4f9b",(0,l.kt)("inlineCode",{parentName:"strong"},"7x24"),"\u5c0f\u65f6\u670d\u52a1\u3002")),(0,l.kt)("h2",{id:"10-nginx\u6267\u884c\u6b65\u9aa4"},"10. nginx\u6267\u884c\u6b65\u9aa4"),(0,l.kt)("p",null,"nginx\u5728\u5904\u7406\u6bcf\u4e00\u4e2a\u7528\u6237\u8bf7\u6c42\u65f6\uff0c\u90fd\u662f\u6309\u7167\u82e5\u5e72\u4e2a\u4e0d\u540c\u7684\u9636\u6bb5\u4f9d\u6b21\u5904\u7406\u7684\uff0c\u4e0e\u914d\u7f6e\u6587\u4ef6\u4e0a\u7684\u987a\u5e8f\u6ca1\u6709\u5173\u7cfb\uff0c\u8be6\u7ec6\u5185\u5bb9\u53ef\u4ee5\u9605\u8bfb\u300a\u6df1\u5165\u7406\u89e3nginx:\u6a21\u5757\u5f00\u53d1\u4e0e\u67b6\u6784\u89e3\u6790\u300b\u8fd9\u672c\u4e66\uff0c\u8fd9\u91cc\u53ea\u505a\u7b80\u5355\u4ecb\u7ecd\uff1b"),(0,l.kt)("p",null,"\uff081\uff09post-read"),(0,l.kt)("p",null,"\u8bfb\u53d6\u8bf7\u6c42\u5185\u5bb9\u9636\u6bb5\uff0cnginx\u8bfb\u53d6\u5e76\u89e3\u6790\u5b8c\u8bf7\u6c42\u5934\u4e4b\u540e\u5c31\u7acb\u5373\u5f00\u59cb\u8fd0\u884c\uff1b"),(0,l.kt)("p",null,"\uff082\uff09server-rewrite"),(0,l.kt)("p",null,"server\u8bf7\u6c42\u5730\u5740\u91cd\u5199\u9636\u6bb5\uff1b"),(0,l.kt)("p",null,"\uff083\uff09find-config"),(0,l.kt)("p",null,"\u914d\u7f6e\u67e5\u627e\u9636\u6bb5\uff0c\u7528\u6765\u5b8c\u6210\u5f53\u524d\u8bf7\u6c42\u4e0elocation\u914d\u91cd\u5757\u4e4b\u95f4\u7684\u914d\u5bf9\u5de5\u4f5c\uff1b"),(0,l.kt)("p",null,"\uff084\uff09rewrite"),(0,l.kt)("p",null,"location\u8bf7\u6c42\u5730\u5740\u91cd\u5199\u9636\u6bb5\uff0c\u5f53ngx_rewrite\u6307\u4ee4\u7528\u4e8elocation\u4e2d\uff0c\u5c31\u662f\u518d\u8fd9\u4e2a\u9636\u6bb5\u8fd0\u884c\u7684\uff1b"),(0,l.kt)("p",null,"\uff085\uff09post-rewrite"),(0,l.kt)("p",null,"\u8bf7\u6c42\u5730\u5740\u91cd\u5199\u63d0\u4ea4\u9636\u6bb5\uff0c\u5f53nginx\u5b8c\u6210rewrite\u9636\u6bb5\u6240\u8981\u6c42\u7684\u5185\u90e8\u8df3\u8f6c\u52a8\u4f5c\uff0c\u5982\u679crewrite\u9636\u6bb5\u6709\u8fd9\u4e2a\u8981\u6c42\u7684\u8bdd\uff1b"),(0,l.kt)("p",null,"\uff086\uff09preaccess"),(0,l.kt)("p",null,"\u8bbf\u95ee\u6743\u9650\u68c0\u67e5\u51c6\u5907\u9636\u6bb5\uff0cngx_limit_req\u548cngx_limit_zone\u5728\u8fd9\u4e2a\u9636\u6bb5\u8fd0\u884c\uff0cngx_limit_req\u53ef\u4ee5\u63a7\u5236\u8bf7\u6c42\u7684\u8bbf\u95ee\u9891\u7387\uff0cngx_limit_zone\u53ef\u4ee5\u63a7\u5236\u8bbf\u95ee\u7684\u5e76\u53d1\u5ea6\uff1b"),(0,l.kt)("p",null,"\uff087\uff09access"),(0,l.kt)("p",null,"\u6743\u9650\u68c0\u67e5\u9636\u6bb5\uff0cngx_access\u5728\u8fd9\u4e2a\u9636\u6bb5\u8fd0\u884c\uff0c\u914d\u7f6e\u6307\u4ee4\u591a\u662f\u6267\u884c\u8bbf\u95ee\u63a7\u5236\u76f8\u5173\u7684\u4efb\u52a1\uff0c\u5982\u68c0\u67e5\u7528\u6237\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u68c0\u67e5\u7528\u6237\u7684\u6765\u6e90IP\u662f\u5426\u5408\u6cd5\uff1b"),(0,l.kt)("p",null,"\uff088\uff09post-access"),(0,l.kt)("p",null,"\u8bbf\u95ee\u6743\u9650\u68c0\u67e5\u63d0\u4ea4\u9636\u6bb5\uff1b"),(0,l.kt)("p",null,"\uff089\uff09try-files"),(0,l.kt)("p",null,"\u914d\u7f6e\u9879try_files\u5904\u7406\u9636\u6bb5\uff1b"),(0,l.kt)("p",null,"\uff0810\uff09content"),(0,l.kt)("p",null,"\u5185\u5bb9\u4ea7\u751f\u9636\u6bb5\uff0c\u662f\u6240\u6709\u8bf7\u6c42\u5904\u7406\u9636\u6bb5\u4e2d\u6700\u4e3a\u91cd\u8981\u7684\u9636\u6bb5\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u9636\u6bb5\u7684\u6307\u4ee4\u901a\u5e38\u662f\u7528\u6765\u751f\u6210HTTP\u54cd\u5e94\u5185\u5bb9\u7684\uff1b"),(0,l.kt)("p",null,"\uff0811\uff09log"),(0,l.kt)("p",null,"\u65e5\u5fd7\u6a21\u5757\u5904\u7406\u9636\u6bb5\uff1b"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://ask.qcloudimg.com/http-save/yehe-1177713/mbrmh847mi.jpeg?imageView2/2/w/1620",alt:"img"})),(0,l.kt)("p",null,"\u56fe\uff1aNginx \u6a21\u5757\u6267\u884c\u987a\u5e8f\u4e0e\u9636\u6bb5"),(0,l.kt)("h2",{id:"11-ngx_lua-\u8fd0\u884c\u6307\u4ee4"},"11. ngx_lua \u8fd0\u884c\u6307\u4ee4"),(0,l.kt)("p",null,"ngx_lua\u5c5e\u4e8enginx\u7684\u4e00\u90e8\u5206\uff0c\u5b83\u7684\u6267\u884c\u6307\u4ee4\u90fd\u5305\u542b\u5728nginx\u768411\u4e2a\u6b65\u9aa4\u4e4b\u4e2d\u4e86\uff0c\u76f8\u5e94\u7684\u5904\u7406\u9636\u6bb5\u53ef\u4ee5\u505a\u63d2\u5165\u5f0f\u5904\u7406\uff0c\u5373\u53ef\u63d2\u62d4\u5f0f\u67b6\u6784\uff0c\u4e0d\u8fc7ngx_lua\u5e76\u4e0d\u662f\u6240\u6709\u9636\u6bb5\u90fd\u4f1a\u8fd0\u884c\u7684\uff1b\u53e6\u5916\u6307\u4ee4\u53ef\u4ee5\u5728http\u3001server\u3001server if\u3001location\u3001location if\u51e0\u4e2a\u8303\u56f4\u8fdb\u884c\u914d\u7f6e\uff1a"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:"left"},"\u6307\u4ee4"),(0,l.kt)("th",{parentName:"tr",align:"left"},"\u6240\u5904\u5904\u7406\u9636\u6bb5"),(0,l.kt)("th",{parentName:"tr",align:"left"},"\u4f7f\u7528\u8303\u56f4"),(0,l.kt)("th",{parentName:"tr",align:"left"},"\u89e3\u91ca"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"init_by_lua init_by_lua_file"),(0,l.kt)("td",{parentName:"tr",align:"left"},"loading-config"),(0,l.kt)("td",{parentName:"tr",align:"left"},"http"),(0,l.kt)("td",{parentName:"tr",align:"left"},"nginx Master\u8fdb\u7a0b\u52a0\u8f7d\u914d\u7f6e\u65f6\u6267\u884c\uff1b \u901a\u5e38\u7528\u4e8e\u521d\u59cb\u5316\u5168\u5c40\u914d\u7f6e/\u9884\u52a0\u8f7dLua\u6a21\u5757")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"init_worker_by_lua init_worker_by_lua_file"),(0,l.kt)("td",{parentName:"tr",align:"left"},"starting-worker"),(0,l.kt)("td",{parentName:"tr",align:"left"},"http"),(0,l.kt)("td",{parentName:"tr",align:"left"},"\u6bcf\u4e2aNginx Worker\u8fdb\u7a0b\u542f\u52a8\u65f6\u8c03\u7528\u7684\u8ba1\u65f6\u5668\uff0c\u5982\u679cMaster\u8fdb\u7a0b\u4e0d\u5141\u8bb8\u5219\u53ea\u4f1a\u5728init_by_lua\u4e4b\u540e\u8c03\u7528\uff1b \u901a\u5e38\u7528\u4e8e\u5b9a\u65f6\u62c9\u53d6\u914d\u7f6e/\u6570\u636e\uff0c\u6216\u8005\u540e\u7aef\u670d\u52a1\u7684\u5065\u5eb7\u68c0\u67e5")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"set_by_lua set_by_lua_file"),(0,l.kt)("td",{parentName:"tr",align:"left"},"rewrite"),(0,l.kt)("td",{parentName:"tr",align:"left"},"server,server if,location,location if"),(0,l.kt)("td",{parentName:"tr",align:"left"},"\u8bbe\u7f6enginx\u53d8\u91cf\uff0c\u53ef\u4ee5\u5b9e\u73b0\u590d\u6742\u7684\u8d4b\u503c\u903b\u8f91\uff1b\u6b64\u5904\u662f\u963b\u585e\u7684\uff0cLua\u4ee3\u7801\u8981\u505a\u5230\u975e\u5e38\u5feb\uff1b")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"rewrite_by_lua rewrite_by_lua_file"),(0,l.kt)("td",{parentName:"tr",align:"left"},"rewrite tail"),(0,l.kt)("td",{parentName:"tr",align:"left"},"http,server,location,location if"),(0,l.kt)("td",{parentName:"tr",align:"left"},"rrewrite\u9636\u6bb5\u5904\u7406\uff0c\u53ef\u4ee5\u5b9e\u73b0\u590d\u6742\u7684\u8f6c\u53d1/\u91cd\u5b9a\u5411\u903b\u8f91\uff1b")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"access_by_lua access_by_lua_file"),(0,l.kt)("td",{parentName:"tr",align:"left"},"access tail"),(0,l.kt)("td",{parentName:"tr",align:"left"},"http,server,location,location if"),(0,l.kt)("td",{parentName:"tr",align:"left"},"\u8bf7\u6c42\u8bbf\u95ee\u9636\u6bb5\u5904\u7406\uff0c\u7528\u4e8e\u8bbf\u95ee\u63a7\u5236")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"content_by_lua content_by_lua_file"),(0,l.kt)("td",{parentName:"tr",align:"left"},"content"),(0,l.kt)("td",{parentName:"tr",align:"left"},"location\uff0clocation if"),(0,l.kt)("td",{parentName:"tr",align:"left"},"\u5185\u5bb9\u5904\u7406\u5668\uff0c\u63a5\u6536\u8bf7\u6c42\u5904\u7406\u5e76\u8f93\u51fa\u54cd\u5e94")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"header_filter_by_lua header_filter_by_lua_file"),(0,l.kt)("td",{parentName:"tr",align:"left"},"output-header-filter"),(0,l.kt)("td",{parentName:"tr",align:"left"},"http\uff0cserver\uff0clocation\uff0clocation if"),(0,l.kt)("td",{parentName:"tr",align:"left"},"\u8bbe\u7f6eheader\u548ccookie")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"body_filter_by_lua body_filter_by_lua_file"),(0,l.kt)("td",{parentName:"tr",align:"left"},"output-body-filter"),(0,l.kt)("td",{parentName:"tr",align:"left"},"http\uff0cserver\uff0clocation\uff0clocation if"),(0,l.kt)("td",{parentName:"tr",align:"left"},"\u5bf9\u54cd\u5e94\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\uff0c\u6bd4\u5982\u622a\u65ad\u3001\u66ff\u6362\u3002")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"log_by_lua log_by_lua_file"),(0,l.kt)("td",{parentName:"tr",align:"left"},"log"),(0,l.kt)("td",{parentName:"tr",align:"left"},"http\uff0cserver\uff0clocation\uff0clocation if"),(0,l.kt)("td",{parentName:"tr",align:"left"},"log\u9636\u6bb5\u5904\u7406\uff0c\u6bd4\u5982\u8bb0\u5f55\u8bbf\u95ee\u91cf/\u7edf\u8ba1\u5e73\u5747\u54cd\u5e94\u65f6\u95f4")))),(0,l.kt)("h2",{id:"\u53c2\u8003"},"\u53c2\u8003"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://juejin.cn/post/6942607113118023710"},"\u4e07\u5b57\u603b\u7ed3\uff0c\u4f53\u7cfb\u5316\u5e26\u4f60\u5168\u9762\u8ba4\u8bc6 Nginx \uff01")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://wizardforcel.gitbooks.io/nginx-doc/content/index.html"},"Nginx\u4e2d\u6587\u6587\u6863 gitbook")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://blog.redis.com.cn/doc/"},"Nginx\u4e2d\u6587\u6587\u6863")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://juejin.cn/post/7112826654291918855"},"Nginx\u4e00\u7f51\u6253\u5c3d\uff1a\u52a8\u9759\u5206\u79bb\u3001\u538b\u7f29\u3001\u7f13\u5b58\u3001\u9ed1\u767d\u540d\u5355\u3001\u8de8\u57df\u3001\u9ad8\u53ef\u7528\u3001\u6027\u80fd\u4f18\u5316...\u60f3\u8981\u7684\u8fd9\u90fd\u6709\uff01"))))}d.isMDXComponent=!0},3661:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20230201105251601-9299115b447f8394643bd32b112c294c.png"},8355:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20230201105307630-9cc5d5aea6683ff882dc55e7966b7b1a.png"},8202:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20230201105339842-c0d689077a386ea43ed3c6949aca49df.png"},2913:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20230201105415442-b33cbde2b916181fc54fc817d67140e0.png"},3751:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image-20230201105444380-43e6ee348aadc67b69ffe991e3267322.png"}}]);